<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GammaCombo: /Users/matt/Scratch/lhcb/CombinationCode/gammacombo/core/src/MethodPluginScan.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GammaCombo
   &#160;<span id="projectnumber">Rev:Unversioneddirectory</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_90fd98a0ba30abf7a6068a44995d2d6b.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MethodPluginScan.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_method_plugin_scan_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Gamma Combination</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Author: Till Moritz Karbach, moritz.karbach@cern.ch</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Date: August 2012</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_method_plugin_scan_8h.html">MethodPluginScan.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#aa4d2d0b64a5886c2f8e5e61dcb0c55b9">   14</a></span>&#160;<a class="code" href="class_method_plugin_scan.html#aa4d2d0b64a5886c2f8e5e61dcb0c55b9">MethodPluginScan::MethodPluginScan</a>(<a class="code" href="class_method_prob_scan.html">MethodProbScan</a>* s)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;: <a class="code" href="class_method_abs_scan.html">MethodAbsScan</a>(s-&gt;getCombiner())</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="class_method_abs_scan.html#a4b338fb0309f7930ccd773db414354e2">methodName</a> = <span class="stringliteral">&quot;Plugin&quot;</span>;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="class_method_abs_scan.html#a3991352427c7713b6167fa9c1dc926e7">title</a> = s-&gt;<a class="code" href="class_method_abs_scan.html#a1df0e00f7c416e2405fffe3be8153d7d">getTitle</a>();</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> = s-&gt;<a class="code" href="class_method_abs_scan.html#a043ca474d289dc12be72e6a3a63432cf">getScanVar1Name</a>();</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a> = s-&gt;<a class="code" href="class_method_abs_scan.html#acd81813bf223ed538c01bf3dce956174">getScanVar2Name</a>();</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a> = s;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a> = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="class_method_abs_scan.html#ade0b5756f286cbbb08395a9baa080fff">setSolutions</a>(s-&gt;<a class="code" href="class_method_abs_scan.html#a1f61bce4ae7f124ece859a29b30c63a2">getSolutions</a>());</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="class_method_abs_scan.html#aae72ccd1a439d3cebdddeb1ac81ffe6e">setChi2minGlobal</a>(s-&gt;<a class="code" href="class_method_abs_scan.html#a5073ddd058b98a555e12b11caac5f204">getChi2minGlobal</a>());</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a> = <span class="keyword">new</span> RooDataSet(<span class="stringliteral">&quot;obsDataset&quot;</span>, <span class="stringliteral">&quot;obsDataset&quot;</span>, *<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>));</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    obsDataset-&gt;add(*<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>));</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a> = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a48af098abd03f950260b42c1c432a3c0">ntoys</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">nPoints1d</a>  = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">npointstoy</a>;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">nPoints2dx</a> = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">npointstoy</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">nPoints2dy</a> = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">npointstoy</a>;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a43bc7da4f19d58ab839684f696f3cd16">   36</a></span>&#160;<a class="code" href="class_method_plugin_scan.html#aa4d2d0b64a5886c2f8e5e61dcb0c55b9">MethodPluginScan::MethodPluginScan</a>(<a class="code" href="class_method_prob_scan.html">MethodProbScan</a>* s, <a class="code" href="class_p_d_f___datasets.html">PDF_Datasets</a>* pdf, <a class="code" href="class_opt_parser.html">OptParser</a>* opt)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    : <a class="code" href="class_method_abs_scan.html">MethodAbsScan</a>(opt),</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>(opt-&gt;ntoys)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="class_method_abs_scan.html#a4b338fb0309f7930ccd773db414354e2">methodName</a> = <span class="stringliteral">&quot;Plugin&quot;</span>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a> = pdf-&gt;<a class="code" href="class_p_d_f___datasets.html#a19a4cb988efbc07d1dbd9f6fede75de1">getObsName</a>();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a> = pdf-&gt;<a class="code" href="class_p_d_f___datasets.html#ad444f8aece4cda843161c84663ecf995">getWorkspace</a>();</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="class_method_abs_scan.html#a3991352427c7713b6167fa9c1dc926e7">title</a> = s-&gt;<a class="code" href="class_method_abs_scan.html#a1df0e00f7c416e2405fffe3be8153d7d">getTitle</a>();</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> = s-&gt;<a class="code" href="class_method_abs_scan.html#a043ca474d289dc12be72e6a3a63432cf">getScanVar1Name</a>();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a> = s-&gt;<a class="code" href="class_method_abs_scan.html#acd81813bf223ed538c01bf3dce956174">getScanVar2Name</a>();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a> = s;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a> = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="class_method_abs_scan.html#ade0b5756f286cbbb08395a9baa080fff">setSolutions</a>(s-&gt;<a class="code" href="class_method_abs_scan.html#a1f61bce4ae7f124ece859a29b30c63a2">getSolutions</a>());</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="class_method_abs_scan.html#aae72ccd1a439d3cebdddeb1ac81ffe6e">setChi2minGlobal</a>(s-&gt;<a class="code" href="class_method_abs_scan.html#a5073ddd058b98a555e12b11caac5f204">getChi2minGlobal</a>());</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a> = <span class="keyword">new</span> RooDataSet(<span class="stringliteral">&quot;obsDataset&quot;</span>, <span class="stringliteral">&quot;obsDataset&quot;</span>, *<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        obsDataset-&gt;add(*<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>));</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a> = opt-&gt;<a class="code" href="class_opt_parser.html#a48af098abd03f950260b42c1c432a3c0">ntoys</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    };</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a7ae4018c2a9da83ba7c98b0e4c90308c">   62</a></span>&#160;    <a class="code" href="class_method_plugin_scan.html#aa4d2d0b64a5886c2f8e5e61dcb0c55b9">MethodPluginScan::MethodPluginScan</a>(<a class="code" href="class_combiner.html">Combiner</a>* comb)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;: <a class="code" href="class_method_abs_scan.html">MethodAbsScan</a>(comb)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="class_method_abs_scan.html#a4b338fb0309f7930ccd773db414354e2">methodName</a> = <span class="stringliteral">&quot;Plugin&quot;</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="class_method_abs_scan.html#a3991352427c7713b6167fa9c1dc926e7">title</a> = comb-&gt;<a class="code" href="class_combiner.html#a042e5238c3a27c9c404e2ce57fd38f5b">getTitle</a>();</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a> = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a> = 0;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a> = <span class="keyword">new</span> RooDataSet(<span class="stringliteral">&quot;obsDataset&quot;</span>, <span class="stringliteral">&quot;obsDataset&quot;</span>, *comb-&gt;<a class="code" href="class_combiner.html#a52da66fe433220563689cc9867b9ef22">getWorkspace</a>()-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a>-&gt;add(*comb-&gt;<a class="code" href="class_combiner.html#a52da66fe433220563689cc9867b9ef22">getWorkspace</a>()-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>));</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a> = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a48af098abd03f950260b42c1c432a3c0">ntoys</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">nPoints1d</a>  = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">npointstoy</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">nPoints2dx</a> = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">npointstoy</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">nPoints2dy</a> = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">npointstoy</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a67571118ba5fe0a03e1a7ff39c9922e7">   84</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_method_plugin_scan.html#a67571118ba5fe0a03e1a7ff39c9922e7">MethodPluginScan::setParevolPLH</a>(<a class="code" href="class_method_prob_scan.html">MethodProbScan</a>* s)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    assert(s);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a> = s;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#ad6186a5870df0ddacc0983d84439b125">  101</a></span>&#160;<a class="code" href="class_roo_slim_fit_result.html">RooSlimFitResult</a>* <a class="code" href="class_method_plugin_scan.html#ad6186a5870df0ddacc0983d84439b125">MethodPluginScan::getParevolPoint</a>(<span class="keywordtype">float</span> scanpoint)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// get point in nuisance parameter space where the toys get generated at</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordtype">int</span> iCurveRes = <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afb7d91a984b4cb12c1bdde8682ef996a">getHCL</a>()-&gt;FindBin(scanpoint)-1;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#ac1c1e282d64ce581c2905bfe868d0477">curveResults</a>[iCurveRes] ){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::getParevolPoint() : ERROR : curve result not found, id=&quot;</span> &lt;&lt; iCurveRes;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;, scanpoint=&quot;</span> &lt;&lt; scanpoint &lt;&lt; endl;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        exit(1);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// check that the scan variable is indeed present</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    RooArgList list = <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#ac1c1e282d64ce581c2905bfe868d0477">curveResults</a>[iCurveRes]-&gt;floatParsFinal();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    list.add(<a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#ac1c1e282d64ce581c2905bfe868d0477">curveResults</a>[iCurveRes]-&gt;constPars());</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    RooRealVar* var = (RooRealVar*)list.find(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> ( !var ){</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::getParevolPoint() : ERROR : &quot;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                   <span class="stringliteral">&quot;scan variable not found in parameter evolution, var=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> &lt;&lt; endl;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::getParevolPoint() : Printout follows:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#ac1c1e282d64ce581c2905bfe868d0477">curveResults</a>[iCurveRes]-&gt;Print();</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        exit(1);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// check if the scan variable here differs from that of</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// the external curve</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> ( fabs((scanpoint-var-&gt;getVal())/scanpoint) &gt; 0.01 ){</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::getParevolPoint() : WARNING : &quot;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                   <span class="stringliteral">&quot;scanpoint and parameter evolution point differ by more than 1%:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        cout &lt;&lt; scanpoint &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; var-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#ac1c1e282d64ce581c2905bfe868d0477">curveResults</a>[iCurveRes];</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a941fb4f3aa086bb212c207df354494b7">  139</a></span>&#160;RooDataSet* <a class="code" href="class_method_plugin_scan.html#a941fb4f3aa086bb212c207df354494b7">MethodPluginScan::generateToys</a>(<span class="keywordtype">int</span> <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>)</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;{</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    RooRandom::randomGenerator()-&gt;SetSeed(0);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    RooMsgService::instance().setStreamStatus(0,kFALSE);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    RooMsgService::instance().setStreamStatus(1,kFALSE);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    RooDataSet* dataset = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;pdf(<a class="code" href="class_method_abs_scan.html#a07b9165df769293df568086b57bad4ab">pdfName</a>)-&gt;generate(*<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>), <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>, AutoBinned(<span class="keyword">false</span>));</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    RooMsgService::instance().setStreamStatus(0,kTRUE);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    RooMsgService::instance().setStreamStatus(1,kTRUE);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// Test toy generation - print out the first 10 toys to stdout.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// Triggered by --qh 5</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a0f75e7d5a24ab582b8966dd7126c3995">isQuickhack</a>(5) ){</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;kD_k3pi&quot;</span>) )  cout &lt;&lt; <span class="stringliteral">&quot;kD_k3pi=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;kD_k3pi&quot;</span>)-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;dD_k3pi&quot;</span>) )  cout &lt;&lt; <span class="stringliteral">&quot;dD_k3pi=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;dD_k3pi&quot;</span>)-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;kD_kskpi&quot;</span>) ) cout &lt;&lt; <span class="stringliteral">&quot;kD_kskpi=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;kD_kskpi&quot;</span>)-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;dD_kskpi&quot;</span>) ) cout &lt;&lt; <span class="stringliteral">&quot;dD_kskpi=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<span class="stringliteral">&quot;dD_kskpi&quot;</span>)-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0; j&lt;10 &amp;&amp; j&lt;<a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>; j++ ){</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keyword">const</span> RooArgSet* toyData = dataset-&gt;get(j);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            toyData-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// The following code is an embarrasment. Something goes wrong</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// in RooFit&#39;s toy generation when a Th2F PDF is used. We try to</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// work around it.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Sometimes there is an error from TFoam (the TH2F clearly isn&#39;t zero):</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// Error in &lt;TFoam::MakeActiveList&gt;: Integrand function is zero</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// Then it proceeds &quot;generating&quot; observables that are, in every toy, set to their boundaries.</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// This happens only for kD_k3pi_obs and kD_kskpi_obs</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// Workaround: If it happens, flucutate the parameters of the histogram</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// ever so slightly and regenerate.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// read the generated values for one variable from the</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// first two toys</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  vector&lt;TString&gt; affected_var;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  affected_var.push_back(<span class="stringliteral">&quot;kD_k3pi&quot;</span>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  affected_var.push_back(<span class="stringliteral">&quot;kD_kskpi&quot;</span>);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">for</span> ( vector&lt;TString&gt;::iterator aff_var_it = affected_var.begin(); aff_var_it != affected_var.end(); aff_var_it++) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    TString aff_obs = *aff_var_it + <span class="stringliteral">&quot;_obs&quot;</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">bool</span> hasAffObs = <span class="keyword">false</span>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordtype">float</span> generatedValues[2];</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;2; i++ ){</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keyword">const</span> RooArgSet* toyData = dataset-&gt;get(i);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      TIterator* it = toyData-&gt;createIterator();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">while</span>(RooRealVar* var = (RooRealVar*)it-&gt;Next()){</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> ( TString(var-&gt;GetName()).Contains(aff_obs) ){</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          hasAffObs = <span class="keyword">true</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          generatedValues[i] = var-&gt;getVal();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keyword">delete</span> it;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// check if they are the same, if so, fluctuate and regenerate</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> ( hasAffObs &amp;&amp; generatedValues[0]==generatedValues[1] ){</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keyword">delete</span> dataset;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      TString dD_aff_var = *aff_var_it;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      dD_aff_var.ReplaceAll(<span class="stringliteral">&quot;kD&quot;</span>,<span class="stringliteral">&quot;dD&quot;</span>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      cout &lt;&lt; aff_obs &lt;&lt; <span class="stringliteral">&quot; GENERATION ERROR AT &quot;</span> &lt;&lt; *aff_var_it &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(*aff_var_it)-&gt;getVal()</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; dD_aff_var &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(dD_aff_var)-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      TRandom3 r;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(*aff_var_it)-&gt;setVal(r.Gaus(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(*aff_var_it)-&gt;getVal(),0.05));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(dD_aff_var)-&gt;setVal(r.Gaus(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(dD_aff_var)-&gt;getVal(),0.04));</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      cout &lt;&lt; aff_obs &lt;&lt; <span class="stringliteral">&quot; SECOND GENERATION AT &quot;</span> &lt;&lt; *aff_var_it &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(*aff_var_it)-&gt;getVal()</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; dD_aff_var &lt;&lt; <span class="stringliteral">&quot;=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(dD_aff_var)-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      RooMsgService::instance().setStreamStatus(0,kFALSE);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      RooMsgService::instance().setStreamStatus(1,kFALSE);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      dataset = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;pdf(<a class="code" href="class_method_abs_scan.html#a07b9165df769293df568086b57bad4ab">pdfName</a>)-&gt;generate(*<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>), <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>, AutoBinned(<span class="keyword">false</span>));</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      RooMsgService::instance().setStreamStatus(0,kTRUE);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      RooMsgService::instance().setStreamStatus(1,kTRUE);       <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;2; i++ ){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keyword">const</span> RooArgSet* toyData = dataset-&gt;get(i);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        TIterator* it = toyData-&gt;createIterator();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">while</span>(RooRealVar* var = (RooRealVar*)it-&gt;Next()){</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;          <span class="keywordflow">if</span> ( TString(var-&gt;GetName()).Contains(aff_obs) ){</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            generatedValues[i] = var-&gt;getVal();</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">delete</span> it;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      cout &lt;&lt; aff_obs &lt;&lt; <span class="stringliteral">&quot; NEW VALUES : toy 0: &quot;</span> &lt;&lt; generatedValues[0] &lt;&lt; <span class="stringliteral">&quot; toy 1: &quot;</span> &lt;&lt; generatedValues[1] &lt;&lt; endl;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> dataset;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#ad27c1fd09d924a880c6b943d4c017876">  264</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_method_plugin_scan.html#ad27c1fd09d924a880c6b943d4c017876">MethodPluginScan::computePvalue1d</a>(<a class="code" href="class_roo_slim_fit_result.html">RooSlimFitResult</a>* plhScan, <span class="keywordtype">double</span> <a class="code" href="class_method_abs_scan.html#ab382c63983536852ea13347354a09a66">chi2minGlobal</a>, <a class="code" href="class_toy_tree.html">ToyTree</a>* t, <span class="keywordtype">int</span> <span class="keywordtype">id</span>,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <a class="code" href="class_fitter.html">Fitter</a>* f, <a class="code" href="class_progress_bar.html">ProgressBar</a> *pb)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// Check inputs.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    assert(plhScan);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    assert(t);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    assert(f);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    assert(pb);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> ( !plhScan-&gt;<a class="code" href="class_roo_slim_fit_result.html#a1940d2c56c8097295272323e740035db">hasParameter</a>(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>) ){</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::getPvalue1d() : ERROR : scan variable not found in plhScan. Exit.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        assert(0);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// Save parameter values that were active at function</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// call. We&#39;ll reset them at the end to be transparent</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// to the outside.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="class_fit_result_cache.html">FitResultCache</a> frCache(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    frCache.<a class="code" href="class_fit_result_cache.html#ad2bc4c400c285a848e85c56d7c6842c4">storeParsAtFunctionCall</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>));</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    frCache.<a class="code" href="class_fit_result_cache.html#a00c5ad67ce4d5b1715b7d9805b1f8c2a">initRoundRobinDB</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>));</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// Set nuisances. This is the point in parameter space where</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// the toys need to be generated.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>, plhScan, <span class="keyword">true</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// Kenzie-Cousins-Highland (randomize nuisance parameters within a uniform range)</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">//   set parameter ranges to their bb range (should be something wide 95, 99% CL)</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keyword">const</span> RooArgSet* pars = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">toysName</a>) ? <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">toysName</a>) : <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    TIterator* it = pars-&gt;createIterator();</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">while</span>(RooRealVar* var = (RooRealVar*)it-&gt;Next()){</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <a class="code" href="namespace_utils.html#a240dfac0ed26bffcd7c9403c546aa27a">setLimit</a>( var, <span class="stringliteral">&quot;bboos&quot;</span> );</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Uniform generating from:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      pars-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="namespace_utils.html#aa2fb91bef0f6564917776743ec747153">randomizeParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Set:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// Cousins-Highland (randomize nuisance parameters according to a Gaussian with their</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// best fit value and uncertainty from the PLH scan)</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Gaussian generating from:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      plhScan-&gt;<a class="code" href="class_roo_slim_fit_result.html#a76e7f4a2df321d22a919bed6c05db763">floatParsFinal</a>().Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="namespace_utils.html#af9726230e560442413b7951d8dd59069">randomizeParametersGaussian</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">toysName</a>, plhScan);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Set:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// save nuisances for start parameters</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    frCache.<a class="code" href="class_fit_result_cache.html#ada4773784f6e1cf1f5d83163e25caaeb">storeParsAtGlobalMin</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>));</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// set and fix scan point</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    RooRealVar *par = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    par-&gt;setConstant(<span class="keyword">true</span>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">float</span> scanpoint = par-&gt;getVal();</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// get the chi2 of the data</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a> = scanpoint;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#adcc4f5eead3005c6b5741d99112cff9c">id</a> = id;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#aa2f568a8bccb63ca73396080d63d6bb3">storeParsPll</a>();</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#a3907a027f285e2cd132cfbce0e343128">storeTheory</a>();</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a> = plhScan-&gt;<a class="code" href="class_roo_slim_fit_result.html#a08d6e4887513492d5501a65950ba029c">minNll</a>();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a> = <a class="code" href="class_method_abs_scan.html#ab382c63983536852ea13347354a09a66">chi2minGlobal</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// Importance sampling</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">int</span> nActualToys = <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a5c3823719fdcd44aa8c48f828f7f5847">importance</a> ){</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordtype">float</span> plhPvalue = TMath::Prob(t-&gt;<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a> - t-&gt;<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a>,1);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        nActualToys = <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>*<a class="code" href="class_method_plugin_scan.html#a6f24739fc1c65a9ef1109684bb547850">importance</a>(plhPvalue);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        pb-&gt;<a class="code" href="class_progress_bar.html#a38e85c69766cc125d04106fdd9afc555">skipSteps</a>(<a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>-nActualToys);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Draw all toy datasets in advance. This is much faster.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    RooDataSet *toyDataSet = <a class="code" href="class_method_plugin_scan.html#a941fb4f3aa086bb212c207df354494b7">generateToys</a>(nActualToys);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0; j&lt;nActualToys; j++ )</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// status bar</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        pb-&gt;<a class="code" href="class_progress_bar.html#a6a430c4e667119b0bed3869b9819d6fc">progress</a>();</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">// 1. Generate toys</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">//    (or select the right one)</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keyword">const</span> RooArgSet* toyData = toyDataSet-&gt;get(j);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>, toyData);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a531e6bb795c996b1ee25fd273b0e5fc7">storeObservables</a>();</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// 2. scan fit</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        par-&gt;setVal(scanpoint);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        par-&gt;setConstant(<span class="keyword">true</span>);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        f-&gt;<a class="code" href="class_fitter.html#a5ca3f87195a89eb23f79c49d24fc8daa">setStartparsFirstFit</a>(frCache.<a class="code" href="class_fit_result_cache.html#a89812bf2593bc75819f9660781ad8017">getRoundRobinNminus</a>(0));</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        f-&gt;<a class="code" href="class_fitter.html#a2d9b573622f19690ad4c9611dd0a3cc6">setStartparsSecondFit</a>(frCache.<a class="code" href="class_fit_result_cache.html#a6ce68f04512df9b0521bcdd23a984d75">getParsAtGlobalMin</a>());</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        f-&gt;<a class="code" href="class_fitter.html#a0e68a56762f43b7b61f50cd8623154b4">fit</a>();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="class_fitter.html#a1da57f3b99a3303850ed4b0d8b222fdd">getStatus</a>()==1 ){</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            f-&gt;<a class="code" href="class_fitter.html#a5ca3f87195a89eb23f79c49d24fc8daa">setStartparsFirstFit</a>(frCache.<a class="code" href="class_fit_result_cache.html#a89812bf2593bc75819f9660781ad8017">getRoundRobinNminus</a>(1));</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            f-&gt;<a class="code" href="class_fitter.html#a2d9b573622f19690ad4c9611dd0a3cc6">setStartparsSecondFit</a>(frCache.<a class="code" href="class_fit_result_cache.html#a89812bf2593bc75819f9660781ad8017">getRoundRobinNminus</a>(2));</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            f-&gt;<a class="code" href="class_fitter.html#a0e68a56762f43b7b61f50cd8623154b4">fit</a>();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a> = f-&gt;<a class="code" href="class_fitter.html#a52b73cd92e9fd87e6c0ab853faea1cf0">getChi2</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a8972016fb1bcd71d91ec6f20cf253691">statusScan</a> = f-&gt;<a class="code" href="class_fitter.html#a1da57f3b99a3303850ed4b0d8b222fdd">getStatus</a>();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a73eed094d360d546b1472e87fbb0e76f">storeParsScan</a>();</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// 3. free fit</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        par-&gt;setConstant(<span class="keyword">false</span>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        f-&gt;<a class="code" href="class_fitter.html#a0e68a56762f43b7b61f50cd8623154b4">fit</a>();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="class_fitter.html#a1da57f3b99a3303850ed4b0d8b222fdd">getStatus</a>()==1 ){</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            f-&gt;<a class="code" href="class_fitter.html#a0e68a56762f43b7b61f50cd8623154b4">fit</a>();</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a> = f-&gt;<a class="code" href="class_fitter.html#a52b73cd92e9fd87e6c0ab853faea1cf0">getChi2</a>();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#ad28bff5a7627de45a87a6d67efc3c49f">statusFree</a> = f-&gt;<a class="code" href="class_fitter.html#a1da57f3b99a3303850ed4b0d8b222fdd">getStatus</a>();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a8fe124525918e9741a8a824d709be392">scanbest</a> = ((RooRealVar*)<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;find(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>))-&gt;getVal();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a29e9168e785045d9cf285534f0c4c444">storeParsFree</a>();</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// 4. store</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">//</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> ( t-&gt;<a class="code" href="class_toy_tree.html#ad28bff5a7627de45a87a6d67efc3c49f">statusFree</a>==0 ) frCache.<a class="code" href="class_fit_result_cache.html#afb3e22e6adf5b766f96e757a9b0153a2">storeParsRoundRobin</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>));</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#aa8fab63fb870977bcdd4ca07dd0428bd">fill</a>();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// clean up</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>, frCache.<a class="code" href="class_fit_result_cache.html#a9e6c2a0af38c5a719fbb9beb71b6ac63">getParsAtFunctionCall</a>());</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>, <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a>-&gt;get(0));</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keyword">delete</span> toyDataSet;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a27f9304b33e6d1adba3d8895ed81d486">  404</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_method_plugin_scan.html#a27f9304b33e6d1adba3d8895ed81d486">MethodPluginScan::getPvalue1d</a>(<a class="code" href="class_roo_slim_fit_result.html">RooSlimFitResult</a>* plhScan, <span class="keywordtype">double</span> <a class="code" href="class_method_abs_scan.html#ab382c63983536852ea13347354a09a66">chi2minGlobal</a>, <a class="code" href="class_toy_tree.html">ToyTree</a>* t, <span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// Create a ToyTree to store the results of all toys</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// (or use the supplied one so we can have a ToyTree</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// that holds a full scan).</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="class_toy_tree.html">ToyTree</a> *myTree = 0;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span> ( !t ){</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        myTree = <span class="keyword">new</span> <a class="code" href="class_toy_tree.html">ToyTree</a>(<a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        myTree-&gt;<a class="code" href="class_toy_tree.html#a0d1e48ee179a4802bc46b3802b8c8a08">init</a>();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        myTree = t;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// Create a fitter</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="class_fitter.html">Fitter</a> *myFit = <span class="keyword">new</span> <a class="code" href="class_fitter.html">Fitter</a>(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>-&gt;<a class="code" href="class_combiner.html#a3b956a98b0af2928e8c60b93d2d9efe7">getPdfName</a>());</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// Create a progress bar</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="class_progress_bar.html">ProgressBar</a> *myPb = <span class="keyword">new</span> <a class="code" href="class_progress_bar.html">ProgressBar</a>(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// do the work</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::getPvalue1d() : computing p-value ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="class_method_plugin_scan.html#ad27c1fd09d924a880c6b943d4c017876">computePvalue1d</a>(plhScan, chi2minGlobal, myTree, <span class="keywordtype">id</span>, myFit, myPb);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// compute p-value</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a31acdc8dd4e3af6ae7717c533afb7075">controlplot</a> ) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="class_control_plots.html">ControlPlots</a> cp(myTree);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        cp.<a class="code" href="class_control_plots.html#a7accbf65a8ee0c247cfc4d95ff79d164">ctrlPlotChi2</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    TH1F *h = <a class="code" href="class_method_plugin_scan.html#a66b80d20fd9a6d67763920d688a4cd83">analyseToys</a>(myTree, <span class="keywordtype">id</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordtype">float</span> scanpoint = plhScan-&gt;<a class="code" href="class_roo_slim_fit_result.html#a6d2e6d8f177543db4555cbf2848b002b">getParVal</a>(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordtype">double</span> pvalue = h-&gt;GetBinContent(h-&gt;FindBin(scanpoint));</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keyword">delete</span> h;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> ( !t ){</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        myTree-&gt;<a class="code" href="class_toy_tree.html#ab288fe3b61a6b6990661798bad2b71b2">writeToFile</a>(Form(<span class="stringliteral">&quot;root/getPvalue1d_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>+<span class="stringliteral">&quot;_run%i.root&quot;</span>, <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#afaf6db4b1a18bf8ef45c717c18cc7a25">nrun</a>));</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">delete</span> myTree;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keyword">delete</span> myFit;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">delete</span> myPb;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> pvalue;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#ab4bb63a0b393eaf70e6a397f93ad6bba">  456</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_method_abs_scan.html#a9c41ad75a73c87263ac2af17db775b01">MethodPluginScan::scan1d</a>(<span class="keywordtype">int</span> nRun)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="class_fitter.html">Fitter</a> *myFit = <span class="keyword">new</span> <a class="code" href="class_fitter.html">Fitter</a>(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>-&gt;<a class="code" href="class_combiner.html#a3b956a98b0af2928e8c60b93d2d9efe7">getPdfName</a>());</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    RooRandom::randomGenerator()-&gt;SetSeed(0);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// Set limit to all parameters.</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>-&gt;<a class="code" href="class_combiner.html#a274f4ba80749257995701d07d1fc0458">loadParameterLimits</a>();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// Define scan parameter and scan range.</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    RooRealVar *par = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    assert(par);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">float</span> min = <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a>-&gt;GetXaxis()-&gt;GetXmin();</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">float</span> max = <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a>-&gt;GetXaxis()-&gt;GetXmax();</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a6dabc773a2bd95aeef55c48cfda79810">verbose</a> ){</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Plugin configuration:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  combination:    &quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a3991352427c7713b6167fa9c1dc926e7">title</a> &lt;&lt; endl;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  scan variable:  &quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> &lt;&lt; endl;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  scan range:     &quot;</span> &lt;&lt; min &lt;&lt; <span class="stringliteral">&quot; ... &quot;</span> &lt;&lt; max &lt;&lt; endl;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  scan steps:     &quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">nPoints1d</a> &lt;&lt; endl;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  par. evolution: &quot;</span> &lt;&lt; (<a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>!=<a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>?<a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a1df0e00f7c416e2405fffe3be8153d7d">getTitle</a>():<span class="stringliteral">&quot;same as combination&quot;</span>) &lt;&lt; endl;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  nToys:          &quot;</span> &lt;&lt; <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a> &lt;&lt; endl;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// Set up toy root tree</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="class_toy_tree.html">ToyTree</a> t(<a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    t.<a class="code" href="class_toy_tree.html#a0d1e48ee179a4802bc46b3802b8c8a08">init</a>();</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    t.<a class="code" href="class_toy_tree.html#adf587e46375e1f7c6abb2e5bf94e8aec">nrun</a> = nRun;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// Save parameter values that were active at function</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// call. We&#39;ll reset them at the end to be transparent</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// to the outside.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="class_fit_result_cache.html">FitResultCache</a> frCache(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    frCache.<a class="code" href="class_fit_result_cache.html#ad2bc4c400c285a848e85c56d7c6842c4">storeParsAtFunctionCall</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>));</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">// for the progress bar: if more than 100 steps, show 50 status messages.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordtype">int</span> allSteps = <a class="code" href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">nPoints1d</a>*<a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="class_progress_bar.html">ProgressBar</a> *pb = <span class="keyword">new</span> <a class="code" href="class_progress_bar.html">ProgressBar</a>(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, allSteps);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// start scan</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan1d() : &quot;</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;PLUGIN scan starting ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">nPoints1d</a>; i++ )</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordtype">float</span> scanpoint = min + (max-min)*(<span class="keywordtype">double</span>)i/(double)nPoints1d + <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a>-&gt;GetBinWidth(1)/2.;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        t.<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a> = scanpoint;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="comment">// don&#39;t scan in unphysical region</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> ( scanpoint &lt; par-&gt;getMin() || scanpoint &gt; par-&gt;getMax() ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// Get nuisances. This is the point in parameter space where</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">// the toys need to be generated.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="class_roo_slim_fit_result.html">RooSlimFitResult</a>* plhScan = <a class="code" href="class_method_plugin_scan.html#ad6186a5870df0ddacc0983d84439b125">getParevolPoint</a>(scanpoint);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">// do the work</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="class_method_plugin_scan.html#ad27c1fd09d924a880c6b943d4c017876">computePvalue1d</a>(plhScan, <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a5073ddd058b98a555e12b11caac5f204">getChi2minGlobal</a>(), &amp;t, i, myFit, pb);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">// reset</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>, frCache.<a class="code" href="class_fit_result_cache.html#a9e6c2a0af38c5a719fbb9beb71b6ac63">getParsAtFunctionCall</a>());</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>, <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a>-&gt;get(0));</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) myFit-&gt;<a class="code" href="class_fitter.html#a5d02c5744f8fc0f1116a986dbe605e41">print</a>();</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    TString dirname = <span class="stringliteral">&quot;root/scan1dPlugin&quot;</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) dirname += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) dirname += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) dirname += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  dirname += <span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    system(<span class="stringliteral">&quot;mkdir -p &quot;</span>+dirname);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  TString fname = <span class="stringliteral">&quot;/scan1dPlugin&quot;</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) fname += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) fname += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) fname += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  fname += Form(<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+scanVar1+<span class="stringliteral">&quot;_run%i.root&quot;</span>,nRun);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    t.<a class="code" href="class_toy_tree.html#ab288fe3b61a6b6990661798bad2b71b2">writeToFile</a>((dirname+fname).Data());</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">delete</span> myFit;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keyword">delete</span> pb;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;}</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#ae06ee8aa6028d257f6b02a162d08d15e">  543</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_method_abs_scan.html#ae555381f1c26bc057f371edf2f62239d">MethodPluginScan::scan2d</a>(<span class="keywordtype">int</span> nRun)</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;{</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    RooRandom::randomGenerator()-&gt;SetSeed(0);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="comment">// Set limit to all parameters.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>-&gt;<a class="code" href="class_combiner.html#a274f4ba80749257995701d07d1fc0458">loadParameterLimits</a>();</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// Define scan parameters and scan range.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    RooRealVar *par1 = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    assert(par1);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">float</span> min1 = <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;GetXaxis()-&gt;GetXmin();</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">float</span> max1 = <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;GetXaxis()-&gt;GetXmax();</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    RooRealVar *par2 = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;var(<a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a>);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    assert(par2);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">float</span> min2 = <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;GetYaxis()-&gt;GetXmin();</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">float</span> max2 = <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;GetYaxis()-&gt;GetXmax();</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a6dabc773a2bd95aeef55c48cfda79810">verbose</a> ){</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Plugin configuration:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  combination:           &quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a3991352427c7713b6167fa9c1dc926e7">title</a> &lt;&lt; endl;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  scan variables:        x=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> &lt;&lt; <span class="stringliteral">&quot;, y=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a> &lt;&lt; endl;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  scan range:            x=[&quot;</span> &lt;&lt; min1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; max1 &lt;&lt; <span class="stringliteral">&quot;], y=[&quot;</span> &lt;&lt; min2 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; max2 &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  scan steps:            x=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">nPoints2dx</a> &lt;&lt; <span class="stringliteral">&quot;, y=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">nPoints2dy</a> &lt;&lt; endl;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  par. evolution:        &quot;</span> &lt;&lt; (<a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>!=<a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>?<a class="code" href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">parevolPLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a1df0e00f7c416e2405fffe3be8153d7d">getTitle</a>():<span class="stringliteral">&quot;same as combination&quot;</span>) &lt;&lt; endl;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  par. evol. scan steps: x=&quot;</span> &lt;&lt; <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[1].size() &lt;&lt; <span class="stringliteral">&quot;, y=&quot;</span> &lt;&lt; <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;  nToys :                &quot;</span> &lt;&lt; <a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a> &lt;&lt; endl;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">// Set up root tree.</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="class_toy_tree.html">ToyTree</a> t(<a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    t.<a class="code" href="class_toy_tree.html#a0d1e48ee179a4802bc46b3802b8c8a08">init</a>();</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    t.<a class="code" href="class_toy_tree.html#adf587e46375e1f7c6abb2e5bf94e8aec">nrun</a> = nRun;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// Save parameter values that were active at function</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// call. We&#39;ll reset them at the end to be transparent</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">// to the outside.</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="class_fit_result_cache.html">FitResultCache</a> frCache(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    frCache.<a class="code" href="class_fit_result_cache.html#ad2bc4c400c285a848e85c56d7c6842c4">storeParsAtFunctionCall</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>));</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// for the status bar</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">int</span> allSteps = <a class="code" href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">nPoints2dx</a>*<a class="code" href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">nPoints2dy</a>*<a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="class_progress_bar.html">ProgressBar</a> *pb = <span class="keyword">new</span> <a class="code" href="class_progress_bar.html">ProgressBar</a>(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, allSteps);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="comment">// limit number of warnings</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">int</span> nWarnExtPointDiffer = 0;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordtype">int</span> nWarnExtPointDifferMax = 10;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="comment">// 1. assume we have already the global minimum</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// start scan</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan2d() : starting ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i1=0; i1&lt;<a class="code" href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">nPoints2dx</a>; i1++ ) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i2=0; i2&lt;<a class="code" href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">nPoints2dy</a>; i2++ )</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        {</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordtype">float</span> scanpoint1 = min1 + (max1-min1)*(<span class="keywordtype">double</span>)i1/(double)nPoints2dx + <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;GetXaxis()-&gt;GetBinWidth(1)/2.;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordtype">float</span> scanpoint2 = min2 + (max2-min2)*(<span class="keywordtype">double</span>)i2/(double)nPoints2dy + <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;GetYaxis()-&gt;GetBinWidth(1)/2.;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            t.<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a> = scanpoint1;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            t.<a class="code" href="class_toy_tree.html#a13ac90d8ad13f98aeff5efc589f41b71">scanpointy</a> = scanpoint2;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="comment">// don&#39;t scan in unphysical region</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">if</span> ( scanpoint1 &lt; par1-&gt;getMin() || scanpoint1 &gt; par1-&gt;getMax() ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="keywordflow">if</span> ( scanpoint2 &lt; par2-&gt;getMin() || scanpoint2 &gt; par2-&gt;getMax() ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="comment">// Get the global chi2 minimum from the fit to data.</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            t.<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a> = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a5073ddd058b98a555e12b11caac5f204">getChi2minGlobal</a>();</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            <span class="comment">// Get nuisances. This is the point in parameter space where</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <span class="comment">// the toys need to be generated.</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            RooArgList *extCurveResult = 0;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="keywordtype">int</span> iCurveRes1 = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a12aeeda5449d392156317c7787a0b332">getHCL2d</a>()-&gt;GetXaxis()-&gt;FindBin(scanpoint1)-1;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <span class="keywordtype">int</span> iCurveRes2 = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a12aeeda5449d392156317c7787a0b332">getHCL2d</a>()-&gt;GetYaxis()-&gt;FindBin(scanpoint2)-1;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="keywordflow">if</span> ( !<a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2] ) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                    printf(<span class="stringliteral">&quot;MethodPluginScan::scan2d() : WARNING : curve result not found, &quot;</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                            <span class="stringliteral">&quot;id=[%i,%i], val=[%f,%f]\n&quot;</span>, iCurveRes1, iCurveRes2, scanpoint1, scanpoint2);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keywordflow">else</span> {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ){</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        printf(<span class="stringliteral">&quot;MethodPluginScan::scan2d() : loading start parameters from external 1-CL curve: &quot;</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                <span class="stringliteral">&quot;id=[%i,%i], val=[%f,%f]\n&quot;</span>, iCurveRes1, iCurveRes2, scanpoint1, scanpoint2);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                    extCurveResult = <span class="keyword">new</span> RooArgList(<a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]-&gt;floatParsFinal());</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          <span class="comment">// Set nuisances. This is the point in parameter space where</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="comment">// the toys need to be generated.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>, extCurveResult);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;          <span class="comment">// Kenzie-Cousins-Highland (randomize nuisance parameters within a uniform range)</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="comment">// set parameter ranges to their bb range (should be something wide 95, 99% CL)</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keyword">const</span> RooArgSet* pars = <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">toysName</a>) ? <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">toysName</a>) : <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            TIterator* it = pars-&gt;createIterator();</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">while</span> ( RooRealVar* var = (RooRealVar*)it-&gt;Next() ) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;              <a class="code" href="namespace_utils.html#a240dfac0ed26bffcd7c9403c546aa27a">setLimit</a>( var, <span class="stringliteral">&quot;bboos&quot;</span> );</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;              cout &lt;&lt; <span class="stringliteral">&quot;Uniform generating from:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;              pars-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="namespace_utils.html#aa2fb91bef0f6564917776743ec747153">randomizeParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;              cout &lt;&lt; <span class="stringliteral">&quot;Set:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            }</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;          }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="comment">// Cousins-Highland (randomize nuisance parameters according to a Gaussian with their</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          <span class="comment">// best fit value and uncertainty from the PLH scan)</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) {</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;              cout &lt;&lt; <span class="stringliteral">&quot;Gaussian generating from:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;              <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]-&gt;floatParsFinal().Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <a class="code" href="namespace_utils.html#af9726230e560442413b7951d8dd59069">randomizeParametersGaussian</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">toysName</a>, <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">verbose</a>) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;              cout &lt;&lt; <span class="stringliteral">&quot;Set:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;              <a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;Print(<span class="stringliteral">&quot;v&quot;</span>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;          }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                    t.<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a> = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]-&gt;minNll();</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                    <span class="comment">// check if the scan variable here differs from that of</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                    <span class="comment">// the external curve</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                    RooArgList list = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]-&gt;floatParsFinal();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    list.add(<a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]-&gt;constPars());</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                    RooRealVar* var1 = (RooRealVar*)list.find(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                    RooRealVar* var2 = (RooRealVar*)list.find(<a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a>);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                    <span class="keywordflow">if</span> ( var1 &amp;&amp; var2 ) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                        <span class="comment">// print warnings</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                        <span class="keywordflow">if</span> ( fabs((scanpoint1-var1-&gt;getVal())/scanpoint1) &gt; 0.01 || fabs((scanpoint2-var2-&gt;getVal())/scanpoint2) &gt; 0.01 ) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                <span class="keywordflow">if</span> ( nWarnExtPointDiffer&lt;nWarnExtPointDifferMax || arg-&gt;debug ) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                        <span class="keywordflow">if</span> ( fabs((scanpoint1-var1-&gt;getVal())/scanpoint1) &gt; 0.01 )</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                                cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan2d() : WARNING : scanpoint1 and external point differ by more than 1%: &quot;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                                                                      &lt;&lt; <span class="stringliteral">&quot;scanpoint1=&quot;</span> &lt;&lt; scanpoint1 &lt;&lt; <span class="stringliteral">&quot; var1=&quot;</span> &lt;&lt; var1-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                        <span class="keywordflow">if</span> ( fabs((scanpoint2-var2-&gt;getVal())/scanpoint2) &gt; 0.01 )</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                                cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan2d() : WARNING : scanpoint2 and external point differ by more than 1%: &quot;</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                                                                      &lt;&lt; <span class="stringliteral">&quot;scanpoint2=&quot;</span> &lt;&lt; scanpoint2 &lt;&lt; <span class="stringliteral">&quot; var2=&quot;</span> &lt;&lt; var2-&gt;getVal() &lt;&lt; endl;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                <span class="keywordflow">if</span> ( nWarnExtPointDiffer==0 ) {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                        cout &lt;&lt; endl;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                        cout &lt;&lt; <span class="stringliteral">&quot;                                       Try using the same number of scan points for both Plugin and Prob.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                        cout &lt;&lt; <span class="stringliteral">&quot;                                       See --npoints, --npoints2dx, --npoints2dy, --npointstoy&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                        cout &lt;&lt; endl;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                <span class="keywordflow">if</span> ( nWarnExtPointDiffer==nWarnExtPointDifferMax ) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                                        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan2d() : WARNING : scanpoint1 and external point differ by more than 1%: [further warnings suppressed.]&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                nWarnExtPointDiffer++;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                    }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan2d() : WARNING : variable 1 or 2 not found&quot;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                              <span class="stringliteral">&quot;, var1=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> &lt;&lt; <span class="stringliteral">&quot;, var2=&quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a> &lt;&lt; endl;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                        cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::scan2d() : Printout follows:&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                        <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">curveResults2d</a>[iCurveRes1][iCurveRes2]-&gt;Print();</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                        exit(1);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="comment">// set and fix scan point</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            par1-&gt;setVal(scanpoint1);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            par2-&gt;setVal(scanpoint2);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            par1-&gt;setConstant(<span class="keyword">true</span>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            par2-&gt;setConstant(<span class="keyword">true</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            <span class="comment">// save nuisances to ToyTree tree</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            t.<a class="code" href="class_toy_tree.html#aa2f568a8bccb63ca73396080d63d6bb3">storeParsPll</a>();</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            t.<a class="code" href="class_toy_tree.html#a3907a027f285e2cd132cfbce0e343128">storeTheory</a>();</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            <span class="comment">// Draw toy datasets in advance. This is much faster.</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            RooDataSet *toyDataSet = <a class="code" href="class_method_plugin_scan.html#a941fb4f3aa086bb212c207df354494b7">generateToys</a>(nToys);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0; j&lt;<a class="code" href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">nToys</a>; j++ )</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                <span class="comment">// status bar</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                pb-&gt;<a class="code" href="class_progress_bar.html#a6a430c4e667119b0bed3869b9819d6fc">progress</a>();</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                <span class="comment">// 1. Load toy dataset</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="keyword">const</span> RooArgSet* toyData = toyDataSet-&gt;get(j);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>, toyData);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                t.<a class="code" href="class_toy_tree.html#a531e6bb795c996b1ee25fd273b0e5fc7">storeObservables</a>();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                <span class="comment">// 2. scan fit</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                par1-&gt;setVal(scanpoint1);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                par2-&gt;setVal(scanpoint2);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                par1-&gt;setConstant(<span class="keyword">true</span>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                par2-&gt;setConstant(<span class="keyword">true</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                RooFitResult *r;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <span class="keywordflow">if</span> ( !<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aab591067f8ec321c0e4eb80e98342192">scanforce</a> ) r = <a class="code" href="namespace_utils.html#a28c18df87e6229c5d5f593184957e957">fitToMinBringBackAngles</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;pdf(<a class="code" href="class_method_abs_scan.html#a07b9165df769293df568086b57bad4ab">pdfName</a>), <span class="keyword">false</span>, -1);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                <span class="keywordflow">else</span>                   r = <a class="code" href="namespace_utils.html#ac3b068ca6b04243c7c48c38619c19ab4">fitToMinForce</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>);</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                t.<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a> = r-&gt;minNll();</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                t.<a class="code" href="class_toy_tree.html#a8972016fb1bcd71d91ec6f20cf253691">statusScan</a> = 0;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                t.<a class="code" href="class_toy_tree.html#a73eed094d360d546b1472e87fbb0e76f">storeParsScan</a>();</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="keyword">delete</span> r;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="comment">// 3. free fit</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                par1-&gt;setVal(scanpoint1);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                par2-&gt;setVal(scanpoint2);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                par1-&gt;setConstant(<span class="keyword">false</span>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                par2-&gt;setConstant(<span class="keyword">false</span>);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                <span class="keywordflow">if</span> ( !<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aab591067f8ec321c0e4eb80e98342192">scanforce</a> ) r = <a class="code" href="namespace_utils.html#a28c18df87e6229c5d5f593184957e957">fitToMinBringBackAngles</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;pdf(<a class="code" href="class_method_abs_scan.html#a07b9165df769293df568086b57bad4ab">pdfName</a>), <span class="keyword">false</span>, -1);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                <span class="keywordflow">else</span>                   r = <a class="code" href="namespace_utils.html#ac3b068ca6b04243c7c48c38619c19ab4">fitToMinForce</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                t.<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a> = r-&gt;minNll();</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                t.<a class="code" href="class_toy_tree.html#ad28bff5a7627de45a87a6d67efc3c49f">statusFree</a> = 0;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                t.<a class="code" href="class_toy_tree.html#a8fe124525918e9741a8a824d709be392">scanbest</a> = ((RooRealVar*)<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;find(<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>))-&gt;getVal();</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                t.<a class="code" href="class_toy_tree.html#ac8d95f690655517a61b1829ce01d7a0e">scanbesty</a> = ((RooRealVar*)<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>-&gt;set(<a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>)-&gt;find(<a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a>))-&gt;getVal();</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                t.<a class="code" href="class_toy_tree.html#a29e9168e785045d9cf285534f0c4c444">storeParsFree</a>();</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="keyword">delete</span> r;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="comment">// 4. store</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="comment">//</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                t.<a class="code" href="class_toy_tree.html#aa8fab63fb870977bcdd4ca07dd0428bd">fill</a>();</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="comment">// reset</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">parsName</a>, frCache.<a class="code" href="class_fit_result_cache.html#a9e6c2a0af38c5a719fbb9beb71b6ac63">getParsAtFunctionCall</a>());</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <a class="code" href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">setParameters</a>(<a class="code" href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">w</a>, <a class="code" href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">obsName</a>, <a class="code" href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">obsDataset</a>-&gt;get(0));</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keyword">delete</span> toyDataSet;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// save tree</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    TString dirname = <span class="stringliteral">&quot;root/scan2dPlugin&quot;</span>;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) dirname += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) dirname += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) dirname += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  dirname += <span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    system(<span class="stringliteral">&quot;mkdir -p &quot;</span>+dirname);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  TString fname = <span class="stringliteral">&quot;/scan2dPlugin&quot;</span>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) fname += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) fname += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) fname += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  fname += Form(<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>+<span class="stringliteral">&quot;_&quot;</span>+scanVar2+<span class="stringliteral">&quot;_run%i.root&quot;</span>,nRun);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    t.<a class="code" href="class_toy_tree.html#ab288fe3b61a6b6990661798bad2b71b2">writeToFile</a>((dirname+fname).Data());</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keyword">delete</span> pb;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00806"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a66b80d20fd9a6d67763920d688a4cd83">  806</a></span>&#160;TH1F* <a class="code" href="class_method_plugin_scan.html#a66b80d20fd9a6d67763920d688a4cd83">MethodPluginScan::analyseToys</a>(<a class="code" href="class_toy_tree.html">ToyTree</a>* t, <span class="keywordtype">int</span> <span class="keywordtype">id</span>)</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;{</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordtype">float</span> halfBinWidth = (t-&gt;<a class="code" href="class_toy_tree.html#aff8496d8eb1780bdd14fbd274a207b40">getScanpointMax</a>()-t-&gt;<a class="code" href="class_toy_tree.html#a76dba9bbd63f95b987789f4c566938ac">getScanpointMin</a>())/(<span class="keywordtype">float</span>)t-&gt;<a class="code" href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">getScanpointN</a>()/2;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">if</span> ( t-&gt;<a class="code" href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">getScanpointN</a>()==1 ) halfBinWidth = 1.;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    TH1F *<a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a>          = <span class="keyword">new</span> TH1F(<a class="code" href="namespace_utils.html#aa2eaac5d4890c406314cb0013d2f5cfd">getUniqueRootName</a>(), <span class="stringliteral">&quot;hCL&quot;</span>, t-&gt;<a class="code" href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">getScanpointN</a>(), t-&gt;<a class="code" href="class_toy_tree.html#a76dba9bbd63f95b987789f4c566938ac">getScanpointMin</a>()-halfBinWidth, t-&gt;<a class="code" href="class_toy_tree.html#aff8496d8eb1780bdd14fbd274a207b40">getScanpointMax</a>()+halfBinWidth);</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    TH1F *h_better     = (TH1F*)hCL-&gt;Clone(<span class="stringliteral">&quot;h_better&quot;</span>);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    TH1F *h_all        = (TH1F*)hCL-&gt;Clone(<span class="stringliteral">&quot;h_all&quot;</span>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    TH1F *h_background = (TH1F*)hCL-&gt;Clone(<span class="stringliteral">&quot;h_background&quot;</span>);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    TH1F *h_gof        = (TH1F*)hCL-&gt;Clone(<span class="stringliteral">&quot;h_gof&quot;</span>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    Long64_t nentries  = t-&gt;<a class="code" href="class_toy_tree.html#a9a56ce4c6bf403eca49dcfdde2748acf">GetEntries</a>();</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    Long64_t nfailed   = 0;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    Long64_t nwrongrun = 0;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    Long64_t ntoysid   = 0; <span class="comment">// if id is not -1, this will count the number of toys with that id</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#a4eb80dde0dacc362a6573d42cf8574e4">activateCoreBranchesOnly</a>(); <span class="comment">// speeds up the event loop</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="class_progress_bar.html">ProgressBar</a> pb(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, nentries);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::analyseToys() : &quot;</span>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;building p-value histogram ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">for</span> (Long64_t i = 0; i &lt; nentries; i++)</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    {</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        pb.<a class="code" href="class_progress_bar.html#a6a430c4e667119b0bed3869b9819d6fc">progress</a>();</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        t-&gt;<a class="code" href="class_toy_tree.html#a1d661253cfbdb065ad3796d35b981fea">GetEntry</a>(i);</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">if</span> ( <span class="keywordtype">id</span>!=-1 &amp;&amp; fabs(t-&gt;<a class="code" href="class_toy_tree.html#adcc4f5eead3005c6b5741d99112cff9c">id</a>-<span class="keywordtype">id</span>)&gt;0.001 ) <span class="keywordflow">continue</span>; </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        ntoysid++;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">// apply cuts</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">if</span> ( ! (fabs(t-&gt;<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>)&lt;500 &amp;&amp; fabs(t-&gt;<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a>)&lt;500</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    &amp;&amp; t-&gt;<a class="code" href="class_toy_tree.html#ad28bff5a7627de45a87a6d67efc3c49f">statusFree</a>==0. &amp;&amp; t-&gt;<a class="code" href="class_toy_tree.html#a8972016fb1bcd71d91ec6f20cf253691">statusScan</a>==0. )</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;           ){</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            nfailed++;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        }</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <span class="comment">// toys from a wrong run</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">if</span> ( <span class="keywordtype">id</span>!=-1 &amp;&amp; ! (fabs(t-&gt;<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a>-<a class="code" href="class_method_abs_scan.html#ab382c63983536852ea13347354a09a66">chi2minGlobal</a>)&lt;0.2) ){</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            nwrongrun++;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="comment">// Cut away toys outside a certain range. This is needed to remove</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">// low statistics spikes to get publication quality log plots.</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="comment">// Also check line 272 in ToyTree.cpp.</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a72e2cfe3fa078a63616fb02cf889c31e">pluginPlotRangeMin</a>!=<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#abb2aa96bb0b16b3dd406662758c8e585">pluginPlotRangeMax</a></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                &amp;&amp; !(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a72e2cfe3fa078a63616fb02cf889c31e">pluginPlotRangeMin</a>&lt;t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    &amp;&amp; t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>&lt;<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#abb2aa96bb0b16b3dd406662758c8e585">pluginPlotRangeMax</a>) ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <span class="comment">// use profile likelihood from internal scan, not the one found in the root files</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a5f29c52609a9a1259aab224f4070d015">intprob</a> ){</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            t-&gt;<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a> = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_prob_scan.html#a9d7e70f45ab16ca37782a0a5ae3fe905">getChi2min</a>(t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="comment">// Check if toys are in physical region.</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="comment">// Don&#39;t enforce t.chi2min-t.chi2minGlobal&gt;0, else it can be hard because due</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="comment">// to little fluctuaions the best fit point can be missing from the plugin plot...</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="keywordtype">bool</span> inPhysicalRegion = t-&gt;<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>-t-&gt;<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a>&gt;0; <span class="comment">//&amp;&amp; t.chi2min-t.chi2minGlobal&gt;0</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="comment">// build test statistic</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">if</span> ( inPhysicalRegion &amp;&amp; t-&gt;<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>-t-&gt;<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a> &gt; t-&gt;<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a>-t-&gt;<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a> ){</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            h_better-&gt;Fill(t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        }</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="comment">// goodness-of-fit</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">if</span> ( inPhysicalRegion &amp;&amp; t-&gt;<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a> &gt; t-&gt;<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a> ){</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            h_gof-&gt;Fill(t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="comment">// all toys</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordflow">if</span> ( inPhysicalRegion ){</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            h_all-&gt;Fill(t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        }</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="comment">// use the unphysical events to estimate background (be careful with this,</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="comment">// at least inspect the control plots to judge if this can be at all reasonable)</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> ( !inPhysicalRegion ){</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            h_background-&gt;Fill(t-&gt;<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::analyseToys() : &quot;</span>;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span>==-1 ){</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;read an average of &quot;</span>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        cout &lt;&lt; (nentries-nfailed)/<a class="code" href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">nPoints1d</a> &lt;&lt; <span class="stringliteral">&quot; toys per scan point.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    }</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;read &quot;</span>;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        cout &lt;&lt; ntoysid &lt;&lt; <span class="stringliteral">&quot; toys at ID &quot;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; endl;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::analyseToys() : &quot;</span>;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;fraction of failed toys: &quot;</span> &lt;&lt; (double)nfailed/(<span class="keywordtype">double</span>)nentries*100. &lt;&lt; <span class="stringliteral">&quot;%.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::analyseToys() : &quot;</span>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;fraction of background toys: &quot;</span> &lt;&lt; h_background-&gt;GetEntries()/(double)nentries*100. &lt;&lt; <span class="stringliteral">&quot;%.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span>==-1 &amp;&amp; nwrongrun&gt;0 ){</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;\nMethodPluginScan::analyseToys() : WARNING : Read toys that differ in global chi2min (wrong run) : &quot;</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            &lt;&lt; (double)nwrongrun/(<span class="keywordtype">double</span>)(nentries-nfailed)*100. &lt;&lt; <span class="stringliteral">&quot;%.\n&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=h_better-&gt;GetNbinsX(); i++)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordtype">float</span> nbetter = h_better-&gt;GetBinContent(i);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordtype">float</span> nall = h_all-&gt;GetBinContent(i);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordtype">float</span> nbackground = h_background-&gt;GetBinContent(i);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">if</span> ( nall == 0. ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="comment">// subtract background</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="comment">// float p = (nbetter-nbackground)/(nall-nbackground);</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">// hCL-&gt;SetBinContent(i, p);</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="comment">// hCL-&gt;SetBinError(i, sqrt(p * (1.-p)/(nall-nbackground)));</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="comment">// don&#39;t subtract background</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordtype">float</span> p = nbetter/nall;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="comment">// attempt to correct for undercoverage</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_method_abs_scan.html#ae8f952a9516f4100a8c89b0f27c5244d">pvalueCorrectorSet</a>) {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            p = <a class="code" href="class_method_abs_scan.html#a2f29c1d8dbc0a7d62f172dcb714b6893">pvalueCorrector</a>-&gt;<a class="code" href="class_p_value_correction.html#a7c9b33683fc3b0e77c834b207c625486">transform</a>(p);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        }</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        hCL-&gt;SetBinContent(i, p);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        hCL-&gt;SetBinError(i, sqrt(p * (1.-p)/nall));</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// goodness-of-fit</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span>==-1 ){</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordtype">int</span> iBinBestFit = hCL-&gt;GetMaximumBin();</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordtype">float</span> assumedbestfitpoint = hCL-&gt;GetBinCenter(iBinBestFit);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <span class="keywordtype">float</span> nGofBetter = h_gof-&gt;GetBinContent(iBinBestFit);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordtype">float</span> nall = h_all-&gt;GetBinContent(iBinBestFit);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordtype">float</span> fitprobabilityVal = nGofBetter/nall;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordtype">float</span> fitprobabilityErr = sqrt(fitprobabilityVal * (1.-fitprobabilityVal)/nall);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::analyseToys() : &quot;</span>;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;fit prob of best-fit point (&quot;</span> &lt;&lt; assumedbestfitpoint &lt;&lt; <span class="stringliteral">&quot;): &quot;</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            &lt;&lt; Form(<span class="stringliteral">&quot;(%.1f+/-%.1f)%%&quot;</span>, fitprobabilityVal*100., fitprobabilityErr*100.) &lt;&lt; endl;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    t-&gt;<a class="code" href="class_toy_tree.html#ae693f0391e064867cb20f0ea12709925">activateAllBranches</a>();</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keyword">delete</span> h_better;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keyword">delete</span> h_all;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keyword">delete</span> h_background;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;}</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a291f6dd595527b317ec35cc30604b2e1">  958</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_method_plugin_scan.html#a291f6dd595527b317ec35cc30604b2e1">MethodPluginScan::readScan1dTrees</a>(<span class="keywordtype">int</span> runMin, <span class="keywordtype">int</span> runMax, TString fName)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;{</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    TChain *c = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;plugin&quot;</span>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">int</span> nFilesMissing = 0;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordtype">int</span> nFilesRead = 0;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// configure file name</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  TString dirname = <span class="stringliteral">&quot;root/scan1dPlugin&quot;</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) dirname += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) dirname += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) dirname += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  dirname += <span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    TString fileNameBase = dirname+<span class="stringliteral">&quot;/scan1dPlugin&quot;</span>;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) fileNameBase += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) fileNameBase += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) fileNameBase += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  fileNameBase += <span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+scanVar1+<span class="stringliteral">&quot;_run&quot;</span>;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// read different files if requested</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">toyFiles</a> != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">toyFiles</a> != <span class="stringliteral">&quot;default&quot;</span> ) fileNameBase = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">toyFiles</a>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan1dTrees() : &quot;</span>;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;reading files: &quot;</span> &lt;&lt; fileNameBase+<span class="stringliteral">&quot;*.root&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=runMin; i&lt;=runMax; i++){</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        TString file = Form(fileNameBase+<span class="stringliteral">&quot;%i.root&quot;</span>, i);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="namespace_utils.html#ae3f723d44400db8a1e99985411f581fa">FileExists</a>(file) ){</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            cout &lt;&lt; <span class="stringliteral">&quot;WARNING : File not found: &quot;</span> + file + <span class="stringliteral">&quot; ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            nFilesMissing += 1;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a6dabc773a2bd95aeef55c48cfda79810">verbose</a> ) cout &lt;&lt; <span class="stringliteral">&quot;reading &quot;</span> + file &lt;&lt; endl;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        c-&gt;Add(file);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        nFilesRead += 1;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan1dTrees() : &quot;</span>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;read toy files: &quot;</span> &lt;&lt; nFilesRead;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">if</span> ( nFilesRead==0 ){</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan1dTrees() : &quot;</span>;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;ERROR : no files read!&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        exit(EXIT_FAILURE);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="class_toy_tree.html">ToyTree</a> t(<a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>, c);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    t.<a class="code" href="class_toy_tree.html#a9fcbbcb84c098ceaf51504d4d4f5e9c2">open</a>();</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a31acdc8dd4e3af6ae7717c533afb7075">controlplot</a> ) {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="class_control_plots.html">ControlPlots</a> cp(&amp;t);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==1 ) cp.<a class="code" href="class_control_plots.html#a2197c4624ae049abce94fdd9bfbddcf8">ctrlPlotMore</a>(<a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==2 ) cp.<a class="code" href="class_control_plots.html#a7accbf65a8ee0c247cfc4d95ff79d164">ctrlPlotChi2</a>();</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==3 ) cp.<a class="code" href="class_control_plots.html#a6c326d80b761c7585fc6e84418b0b31a">ctrlPlotNuisances</a>();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==4 ) cp.<a class="code" href="class_control_plots.html#aea3d6bd801478b994631a386a3cba883">ctrlPlotObservables</a>();</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==5 ) cp.<a class="code" href="class_control_plots.html#a10e04d68921beb2316c1d10ce3e0b82b">ctrlPlotChi2Distribution</a>();</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==6 ) cp.<a class="code" href="class_control_plots.html#a3b6ccecf4a199d12ed018182297c4176">ctrlPlotChi2Parabola</a>();</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==7 ) cp.<a class="code" href="class_control_plots.html#ae7f0ede8f8139ff6546425e6104e4cc5">ctrlPlotPvalue</a>();</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        cp.<a class="code" href="class_control_plots.html#a98658a5b67fa01e38aec5dab43678ece">saveCtrlPlots</a>();</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    }</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a> ) <span class="keyword">delete</span> <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a>;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">hCL</a> = <a class="code" href="class_method_plugin_scan.html#a66b80d20fd9a6d67763920d688a4cd83">analyseToys</a>(&amp;t, -1);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;}</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a8106f9ab1c1df885657a9c359a635d52"> 1024</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_method_plugin_scan.html#a8106f9ab1c1df885657a9c359a635d52">MethodPluginScan::readScan2dTrees</a>(<span class="keywordtype">int</span> runMin, <span class="keywordtype">int</span> runMax)</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;{</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    TChain *chain = <span class="keyword">new</span> TChain(<span class="stringliteral">&quot;plugin&quot;</span>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordtype">int</span> nFilesMissing = 0;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordtype">int</span> nFilesRead = 0;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// configure file name</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  TString dirname = <span class="stringliteral">&quot;root/scan2dPlugin&quot;</span>;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) dirname += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) dirname += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) dirname += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  dirname += <span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">scanVar2</a>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    TString fileNameBase = dirname+<span class="stringliteral">&quot;/scan2dPlugin&quot;</span>;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;bb&quot;</span>) ) fileNameBase += <span class="stringliteral">&quot;BergerBoos&quot;</span>;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;uniform&quot;</span>) ) fileNameBase += <span class="stringliteral">&quot;Uniform&quot;</span>;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">isAction</a>(<span class="stringliteral">&quot;gaus&quot;</span>) ) fileNameBase += <span class="stringliteral">&quot;Gaus&quot;</span>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  fileNameBase += <span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">name</a>+<span class="stringliteral">&quot;_&quot;</span>+<a class="code" href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">scanVar1</a>+<span class="stringliteral">&quot;_&quot;</span>+scanVar2+<span class="stringliteral">&quot;_run&quot;</span>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="comment">// read different file if requested</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">toyFiles</a> != <span class="stringliteral">&quot;&quot;</span> &amp;&amp; <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">toyFiles</a> != <span class="stringliteral">&quot;default&quot;</span> ) fileNameBase = <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">toyFiles</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan2dTrees() : &quot;</span>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;reading files: &quot;</span> &lt;&lt; fileNameBase+<span class="stringliteral">&quot;*.root&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=runMin; i&lt;=runMax; i++) {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        TString file = Form(fileNameBase+<span class="stringliteral">&quot;%i.root&quot;</span>, i);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        <span class="keywordflow">if</span> ( !<a class="code" href="namespace_utils.html#ae3f723d44400db8a1e99985411f581fa">FileExists</a>(file) ) {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a6dabc773a2bd95aeef55c48cfda79810">verbose</a> ) cout &lt;&lt; <span class="stringliteral">&quot;ERROR : File not found: &quot;</span> + file + <span class="stringliteral">&quot; ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            nFilesMissing += 1;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        }</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a6dabc773a2bd95aeef55c48cfda79810">verbose</a> ) cout &lt;&lt; <span class="stringliteral">&quot;reading &quot;</span> + file + <span class="stringliteral">&quot; ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        chain-&gt;Add(file);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        nFilesRead += 1;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;read toy files: &quot;</span> &lt;&lt; nFilesRead;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;, missing files: &quot;</span> &lt;&lt; nFilesMissing &lt;&lt; endl;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> ( nFilesRead==0 ){</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan2dTrees() : &quot;</span>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;ERROR : no files read!&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        exit(1);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <a class="code" href="class_toy_tree.html">ToyTree</a> t(<a class="code" href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">combiner</a>, chain);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    t.<a class="code" href="class_toy_tree.html#a9fcbbcb84c098ceaf51504d4d4f5e9c2">open</a>();</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a31acdc8dd4e3af6ae7717c533afb7075">controlplot</a> ) {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <a class="code" href="class_control_plots.html">ControlPlots</a> cp(&amp;t);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">//if ( arg-&gt;plotid==0 || arg-&gt;plotid==1 ) cp.ctrlPlotMore(profileLH);</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==2 ) cp.<a class="code" href="class_control_plots.html#a7accbf65a8ee0c247cfc4d95ff79d164">ctrlPlotChi2</a>();</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==3 ) cp.<a class="code" href="class_control_plots.html#a6c326d80b761c7585fc6e84418b0b31a">ctrlPlotNuisances</a>();</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==4 ) cp.<a class="code" href="class_control_plots.html#aea3d6bd801478b994631a386a3cba883">ctrlPlotObservables</a>();</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==5 ) cp.<a class="code" href="class_control_plots.html#a10e04d68921beb2316c1d10ce3e0b82b">ctrlPlotChi2Distribution</a>();</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==6 ) cp.<a class="code" href="class_control_plots.html#a3b6ccecf4a199d12ed018182297c4176">ctrlPlotChi2Parabola</a>();</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==0 || <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">plotid</a>==7 ) cp.<a class="code" href="class_control_plots.html#ae7f0ede8f8139ff6546425e6104e4cc5">ctrlPlotPvalue</a>();</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        cp.<a class="code" href="class_control_plots.html#a98658a5b67fa01e38aec5dab43678ece">saveCtrlPlots</a>();</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordtype">float</span> halfBinWidthx = (t.<a class="code" href="class_toy_tree.html#aff8496d8eb1780bdd14fbd274a207b40">getScanpointMax</a>()-t.<a class="code" href="class_toy_tree.html#a76dba9bbd63f95b987789f4c566938ac">getScanpointMin</a>())/(<span class="keywordtype">float</span>)t.<a class="code" href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">getScanpointN</a>()/2;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">float</span> halfBinWidthy = (t.<a class="code" href="class_toy_tree.html#affd9b4e5140f164a8070b19ef9d5d711">getScanpointyMax</a>()-t.<a class="code" href="class_toy_tree.html#a037a5472be834d5eaad3c7dba7e375b8">getScanpointyMin</a>())/(<span class="keywordtype">float</span>)t.<a class="code" href="class_toy_tree.html#add900d64485baf7f0bf3881a2f3002c5">getScanpointyN</a>()/2;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">if</span> ( t.<a class="code" href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">getScanpointN</a>()==1 )  halfBinWidthx = 1.;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">if</span> ( t.<a class="code" href="class_toy_tree.html#add900d64485baf7f0bf3881a2f3002c5">getScanpointyN</a>()==1 ) halfBinWidthy = 1.;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a> ) <span class="keyword">delete</span> <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>          = <span class="keyword">new</span> TH2F(<a class="code" href="namespace_utils.html#aa2eaac5d4890c406314cb0013d2f5cfd">getUniqueRootName</a>(), <span class="stringliteral">&quot;hCL2d&quot;</span>, t.<a class="code" href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">getScanpointN</a>(), t.<a class="code" href="class_toy_tree.html#a76dba9bbd63f95b987789f4c566938ac">getScanpointMin</a>()-halfBinWidthx, t.<a class="code" href="class_toy_tree.html#aff8496d8eb1780bdd14fbd274a207b40">getScanpointMax</a>()+halfBinWidthx,</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                                            t.<a class="code" href="class_toy_tree.html#add900d64485baf7f0bf3881a2f3002c5">getScanpointyN</a>(), t.<a class="code" href="class_toy_tree.html#a037a5472be834d5eaad3c7dba7e375b8">getScanpointyMin</a>()-halfBinWidthx, t.<a class="code" href="class_toy_tree.html#affd9b4e5140f164a8070b19ef9d5d711">getScanpointyMax</a>()+halfBinWidthx);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    TH2F *h_better = (TH2F*)<a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;Clone(<span class="stringliteral">&quot;h_better&quot;</span>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    TH2F *h_all    = (TH2F*)<a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;Clone(<span class="stringliteral">&quot;h_all&quot;</span>);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    Long64_t nentries = t.<a class="code" href="class_toy_tree.html#a9a56ce4c6bf403eca49dcfdde2748acf">GetEntries</a>();</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    Long64_t nfailed = 0;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    Long64_t nwrongrun = 0;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    Long64_t ntoysid   = 0; <span class="comment">// if id is not -1, this will count the number of toys with that id</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    t.<a class="code" href="class_toy_tree.html#a4eb80dde0dacc362a6573d42cf8574e4">activateCoreBranchesOnly</a>(); <span class="comment">// speeds up the event loop</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <a class="code" href="class_progress_bar.html">ProgressBar</a> pb(<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>, nentries);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan2dTrees() : &quot;</span>;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;building p-value histogram ...&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="keywordflow">for</span> (Long64_t i = 0; i &lt; nentries; i++)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        pb.<a class="code" href="class_progress_bar.html#a6a430c4e667119b0bed3869b9819d6fc">progress</a>();</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        t.<a class="code" href="class_toy_tree.html#a1d661253cfbdb065ad3796d35b981fea">GetEntry</a>(i);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ae9380482af3f93c022ac948a8ef2c276">id</a>!=-1 &amp;&amp; fabs(t.<a class="code" href="class_toy_tree.html#adcc4f5eead3005c6b5741d99112cff9c">id</a>-<a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ae9380482af3f93c022ac948a8ef2c276">id</a>)&gt;0.001 ) <span class="keywordflow">continue</span>; </div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        ntoysid++;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment">// apply cuts</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">if</span> ( ! (t.<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a> &gt; -1e10 &amp;&amp; t.<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a> &gt; -1e10</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    &amp;&amp; t.<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>-t.<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a>&gt;0</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                    <span class="comment">// \todo uncomment this line once chi2minGlobal gets stored in the saved scanner</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    <span class="comment">//&amp;&amp; fabs((chi2minGlobal_t-chi2minGlobal)/(chi2minGlobal_t+chi2minGlobal))&lt;0.01 // reject files from other runs</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                    &amp;&amp; t.<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>&lt;1000</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;               ))</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;            nfailed++;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <span class="comment">// toys from a wrong run</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ae9380482af3f93c022ac948a8ef2c276">id</a>!=-1 &amp;&amp; ! (fabs(t.<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a>-<a class="code" href="class_method_abs_scan.html#ab382c63983536852ea13347354a09a66">chi2minGlobal</a>)&lt;0.2) ){</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            nwrongrun++;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="comment">// use profile likelihood from internal scan, not the one found in the root files</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#a5f29c52609a9a1259aab224f4070d015">intprob</a> ){</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="keywordtype">int</span> iBin = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a231bde799714ab862d60bb660a2e4e1a">getHchisq2d</a>()-&gt;FindBin(t.<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>,t.<a class="code" href="class_toy_tree.html#a13ac90d8ad13f98aeff5efc589f41b71">scanpointy</a>);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            t.<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a> = <a class="code" href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">profileLH</a>-&gt;<a class="code" href="class_method_abs_scan.html#a231bde799714ab862d60bb660a2e4e1a">getHchisq2d</a>()-&gt;GetBinContent(iBin);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <span class="comment">// Check if toys are in physical region.</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordtype">bool</span> inPhysicalRegion = t.<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>-t.<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a>&gt;0;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">// build test statistic</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">if</span> ( inPhysicalRegion &amp;&amp; t.<a class="code" href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">chi2minToy</a>-t.<a class="code" href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">chi2minGlobalToy</a> &gt; t.<a class="code" href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">chi2min</a>-t.<a class="code" href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">chi2minGlobal</a> ) {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            h_better-&gt;Fill(t.<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>,t.<a class="code" href="class_toy_tree.html#a13ac90d8ad13f98aeff5efc589f41b71">scanpointy</a>);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="comment">// all toys</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">if</span> ( inPhysicalRegion ){</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            h_all-&gt;Fill(t.<a class="code" href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">scanpoint</a>,t.<a class="code" href="class_toy_tree.html#a13ac90d8ad13f98aeff5efc589f41b71">scanpointy</a>);</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan2dTrees() : &quot;</span>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ae9380482af3f93c022ac948a8ef2c276">id</a>==-1 ){</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;read an average of &quot;</span> &lt;&lt; (nentries-nfailed)/<a class="code" href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">nPoints2dx</a>/<a class="code" href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">nPoints2dy</a> &lt;&lt; <span class="stringliteral">&quot; toys per scan point.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">else</span>{</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;read &quot;</span>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        cout &lt;&lt; ntoysid &lt;&lt; <span class="stringliteral">&quot; toys at ID &quot;</span> &lt;&lt; <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ae9380482af3f93c022ac948a8ef2c276">id</a> &lt;&lt; endl;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">arg</a>-&gt;<a class="code" href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">debug</a> ) cout &lt;&lt; <span class="stringliteral">&quot;MethodPluginScan::readScan2dTrees() : &quot;</span>;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;fraction of failed toys: &quot;</span> &lt;&lt; (double)nfailed/(<span class="keywordtype">double</span>)nentries*100. &lt;&lt; <span class="stringliteral">&quot;%.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <span class="comment">// compute 1-CL</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=h_better-&gt;GetNbinsX(); i++){</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j&lt;=h_better-&gt;GetNbinsY(); j++){</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordtype">float</span> nbetter = h_better-&gt;GetBinContent(i,j);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="keywordtype">float</span> nall = h_all-&gt;GetBinContent(i,j);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordflow">if</span> ( nall == 0. ) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            <span class="keywordtype">float</span> p = nbetter/nall;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;SetBinContent(i, j, p);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            <a class="code" href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">hCL2d</a>-&gt;SetBinError(i, j, sqrt(p * (1.-p)/nall));</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    }</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    t.<a class="code" href="class_toy_tree.html#ae693f0391e064867cb20f0ea12709925">activateAllBranches</a>();</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keyword">delete</span> h_better;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keyword">delete</span> h_all;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"><a class="line" href="class_method_plugin_scan.html#a6f24739fc1c65a9ef1109684bb547850"> 1181</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_method_plugin_scan.html#a6f24739fc1c65a9ef1109684bb547850">MethodPluginScan::importance</a>(<span class="keywordtype">double</span> pvalue)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;{</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordtype">double</span> f1 = 0.05;  </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordtype">double</span> co = 1e-5;  </div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">if</span> ( pvalue&lt;co ) <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordtype">double</span> f = (1.-pvalue)/pvalue/30.;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span> ( f&gt;1. ) <span class="keywordflow">return</span> 1.;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="keywordflow">if</span> ( f&lt;f1 ) <span class="keywordflow">return</span> f1;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">return</span> f;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;}</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="ttc" id="class_method_abs_scan_html_ac1c1e282d64ce581c2905bfe868d0477"><div class="ttname"><a href="class_method_abs_scan.html#ac1c1e282d64ce581c2905bfe868d0477">MethodAbsScan::curveResults</a></div><div class="ttdeci">vector&lt; RooSlimFitResult * &gt; curveResults</div><div class="ttdoc">All fit results of the the points that make it into the 1-CL curve. </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00144">MethodAbsScan.h:144</a></div></div>
<div class="ttc" id="class_control_plots_html"><div class="ttname"><a href="class_control_plots.html">ControlPlots</a></div><div class="ttdoc">Class to make control plots of Plugin toys. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8h_source.html#l00030">ControlPlots.h:30</a></div></div>
<div class="ttc" id="class_fitter_html_a0e68a56762f43b7b61f50cd8623154b4"><div class="ttname"><a href="class_fitter.html#a0e68a56762f43b7b61f50cd8623154b4">Fitter::fit</a></div><div class="ttdeci">void fit()</div><div class="ttdoc">Run the fit. </div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8cpp_source.html#l00112">Fitter.cpp:112</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a1f61bce4ae7f124ece859a29b30c63a2"><div class="ttname"><a href="class_method_abs_scan.html#a1f61bce4ae7f124ece859a29b30c63a2">MethodAbsScan::getSolutions</a></div><div class="ttdeci">vector&lt; RooSlimFitResult * &gt; getSolutions()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00097">MethodAbsScan.h:97</a></div></div>
<div class="ttc" id="class_opt_parser_html_ac52bcb071ec039dab852b602bf1a433a"><div class="ttname"><a href="class_opt_parser.html#ac52bcb071ec039dab852b602bf1a433a">OptParser::debug</a></div><div class="ttdeci">bool debug</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00051">OptParser.h:51</a></div></div>
<div class="ttc" id="class_toy_tree_html_a76dba9bbd63f95b987789f4c566938ac"><div class="ttname"><a href="class_toy_tree.html#a76dba9bbd63f95b987789f4c566938ac">ToyTree::getScanpointMin</a></div><div class="ttdeci">float getScanpointMin()</div><div class="ttdoc">Get minimum of scanpoint variable found in the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00468">ToyTree.cpp:468</a></div></div>
<div class="ttc" id="class_opt_parser_html_afaf6db4b1a18bf8ef45c717c18cc7a25"><div class="ttname"><a href="class_opt_parser.html#afaf6db4b1a18bf8ef45c717c18cc7a25">OptParser::nrun</a></div><div class="ttdeci">int nrun</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00088">OptParser.h:88</a></div></div>
<div class="ttc" id="namespace_utils_html_af9726230e560442413b7951d8dd59069"><div class="ttname"><a href="namespace_utils.html#af9726230e560442413b7951d8dd59069">Utils::randomizeParametersGaussian</a></div><div class="ttdeci">void randomizeParametersGaussian(RooWorkspace *w, TString setname, RooSlimFitResult *r)</div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00432">Utils.cpp:432</a></div></div>
<div class="ttc" id="class_combiner_html_a3b956a98b0af2928e8c60b93d2d9efe7"><div class="ttname"><a href="class_combiner.html#a3b956a98b0af2928e8c60b93d2d9efe7">Combiner::getPdfName</a></div><div class="ttdeci">TString getPdfName() const</div><div class="ttdef"><b>Definition:</b> <a href="_combiner_8h_source.html#l00050">Combiner.h:50</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_ab382c63983536852ea13347354a09a66"><div class="ttname"><a href="class_method_abs_scan.html#ab382c63983536852ea13347354a09a66">MethodAbsScan::chi2minGlobal</a></div><div class="ttdeci">double chi2minGlobal</div><div class="ttdoc">chi2 value at global minimum </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00191">MethodAbsScan.h:191</a></div></div>
<div class="ttc" id="class_fitter_html_a2d9b573622f19690ad4c9611dd0a3cc6"><div class="ttname"><a href="class_fitter.html#a2d9b573622f19690ad4c9611dd0a3cc6">Fitter::setStartparsSecondFit</a></div><div class="ttdeci">void setStartparsSecondFit(const RooArgSet *pars)</div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8h_source.html#l00035">Fitter.h:35</a></div></div>
<div class="ttc" id="class_toy_tree_html_a4eb80dde0dacc362a6573d42cf8574e4"><div class="ttname"><a href="class_toy_tree.html#a4eb80dde0dacc362a6573d42cf8574e4">ToyTree::activateCoreBranchesOnly</a></div><div class="ttdeci">void activateCoreBranchesOnly()</div><div class="ttdoc">Activate only core branches to speed up reading them. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00255">ToyTree.cpp:255</a></div></div>
<div class="ttc" id="class_progress_bar_html"><div class="ttname"><a href="class_progress_bar.html">ProgressBar</a></div><div class="ttdoc">Class showing a progress bar. </div><div class="ttdef"><b>Definition:</b> <a href="_progress_bar_8h_source.html#l00020">ProgressBar.h:20</a></div></div>
<div class="ttc" id="class_fitter_html_a5ca3f87195a89eb23f79c49d24fc8daa"><div class="ttname"><a href="class_fitter.html#a5ca3f87195a89eb23f79c49d24fc8daa">Fitter::setStartparsFirstFit</a></div><div class="ttdeci">void setStartparsFirstFit(const RooArgSet *pars)</div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8h_source.html#l00034">Fitter.h:34</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a231bde799714ab862d60bb660a2e4e1a"><div class="ttname"><a href="class_method_abs_scan.html#a231bde799714ab862d60bb660a2e4e1a">MethodAbsScan::getHchisq2d</a></div><div class="ttdeci">TH2F * getHchisq2d()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00077">MethodAbsScan.h:77</a></div></div>
<div class="ttc" id="class_toy_tree_html_affd9b4e5140f164a8070b19ef9d5d711"><div class="ttname"><a href="class_toy_tree.html#affd9b4e5140f164a8070b19ef9d5d711">ToyTree::getScanpointyMax</a></div><div class="ttdeci">float getScanpointyMax()</div><div class="ttdoc">Get maximum of scanpointy variable found in the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00504">ToyTree.cpp:504</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_acd81813bf223ed538c01bf3dce956174"><div class="ttname"><a href="class_method_abs_scan.html#acd81813bf223ed538c01bf3dce956174">MethodAbsScan::getScanVar2Name</a></div><div class="ttdeci">TString getScanVar2Name()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8cpp_source.html#l00949">MethodAbsScan.cpp:949</a></div></div>
<div class="ttc" id="class_opt_parser_html_a6dabc773a2bd95aeef55c48cfda79810"><div class="ttname"><a href="class_opt_parser.html#a6dabc773a2bd95aeef55c48cfda79810">OptParser::verbose</a></div><div class="ttdeci">bool verbose</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00149">OptParser.h:149</a></div></div>
<div class="ttc" id="class_control_plots_html_a7accbf65a8ee0c247cfc4d95ff79d164"><div class="ttname"><a href="class_control_plots.html#a7accbf65a8ee0c247cfc4d95ff79d164">ControlPlots::ctrlPlotChi2</a></div><div class="ttdeci">void ctrlPlotChi2()</div><div class="ttdoc">Make chi2 summary control plots. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00106">ControlPlots.cpp:106</a></div></div>
<div class="ttc" id="class_progress_bar_html_a6a430c4e667119b0bed3869b9819d6fc"><div class="ttname"><a href="class_progress_bar.html#a6a430c4e667119b0bed3869b9819d6fc">ProgressBar::progress</a></div><div class="ttdeci">void progress()</div><div class="ttdoc">Call this from inside the loop. </div><div class="ttdef"><b>Definition:</b> <a href="_progress_bar_8cpp_source.html#l00020">ProgressBar.cpp:20</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_ad27c1fd09d924a880c6b943d4c017876"><div class="ttname"><a href="class_method_plugin_scan.html#ad27c1fd09d924a880c6b943d4c017876">MethodPluginScan::computePvalue1d</a></div><div class="ttdeci">void computePvalue1d(RooSlimFitResult *plhScan, double chi2minGlobal, ToyTree *t, int id, Fitter *f, ProgressBar *pb)</div><div class="ttdoc">Compute the p-value at a certain point in parameter space using the plugin method. </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00264">MethodPluginScan.cpp:264</a></div></div>
<div class="ttc" id="class_toy_tree_html_a9fcbbcb84c098ceaf51504d4d4f5e9c2"><div class="ttname"><a href="class_toy_tree.html#a9fcbbcb84c098ceaf51504d4d4f5e9c2">ToyTree::open</a></div><div class="ttdeci">void open()</div><div class="ttdoc">Provide the interface to read an external TChain. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00217">ToyTree.cpp:217</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a291f6dd595527b317ec35cc30604b2e1"><div class="ttname"><a href="class_method_plugin_scan.html#a291f6dd595527b317ec35cc30604b2e1">MethodPluginScan::readScan1dTrees</a></div><div class="ttdeci">virtual void readScan1dTrees(int runMin=1, int runMax=1, TString fName=&quot;default&quot;)</div><div class="ttdoc">Read in the TTrees that were produced by scan1d(). </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00958">MethodPluginScan.cpp:958</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_abeb6fe26fd2d64067fc329211436a7fa"><div class="ttname"><a href="class_method_abs_scan.html#abeb6fe26fd2d64067fc329211436a7fa">MethodAbsScan::nPoints1d</a></div><div class="ttdeci">int nPoints1d</div><div class="ttdoc">number of scan points used by 1d scan </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00167">MethodAbsScan.h:167</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_ae8f952a9516f4100a8c89b0f27c5244d"><div class="ttname"><a href="class_method_abs_scan.html#ae8f952a9516f4100a8c89b0f27c5244d">MethodAbsScan::pvalueCorrectorSet</a></div><div class="ttdeci">bool pvalueCorrectorSet</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00172">MethodAbsScan.h:172</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_ab4f1c5112a84882c26d0c9dff97c9881"><div class="ttname"><a href="class_method_abs_scan.html#ab4f1c5112a84882c26d0c9dff97c9881">MethodAbsScan::arg</a></div><div class="ttdeci">OptParser * arg</div><div class="ttdoc">command line options </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00204">MethodAbsScan.h:204</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a66b80d20fd9a6d67763920d688a4cd83"><div class="ttname"><a href="class_method_plugin_scan.html#a66b80d20fd9a6d67763920d688a4cd83">MethodPluginScan::analyseToys</a></div><div class="ttdeci">TH1F * analyseToys(ToyTree *t, int id=-1)</div><div class="ttdoc">Analyse toys that were written either by a scan or a by getPvalue(). </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00806">MethodPluginScan.cpp:806</a></div></div>
<div class="ttc" id="class_control_plots_html_a6c326d80b761c7585fc6e84418b0b31a"><div class="ttname"><a href="class_control_plots.html#a6c326d80b761c7585fc6e84418b0b31a">ControlPlots::ctrlPlotNuisances</a></div><div class="ttdeci">void ctrlPlotNuisances()</div><div class="ttdoc">Plot all fit results of the nuisances against the scan variable. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00249">ControlPlots.cpp:249</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_acfd99d46d4fa7eb62ec7e0771da2dd32"><div class="ttname"><a href="class_method_abs_scan.html#acfd99d46d4fa7eb62ec7e0771da2dd32">MethodAbsScan::toysName</a></div><div class="ttdeci">TString toysName</div><div class="ttdoc">set name of parameters to vary in toys </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00164">MethodAbsScan.h:164</a></div></div>
<div class="ttc" id="class_toy_tree_html_a1d661253cfbdb065ad3796d35b981fea"><div class="ttname"><a href="class_toy_tree.html#a1d661253cfbdb065ad3796d35b981fea">ToyTree::GetEntry</a></div><div class="ttdeci">void GetEntry(Long64_t i)</div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00383">ToyTree.cpp:383</a></div></div>
<div class="ttc" id="class_opt_parser_html"><div class="ttname"><a href="class_opt_parser.html">OptParser</a></div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00022">OptParser.h:22</a></div></div>
<div class="ttc" id="class_opt_parser_html_a72e2cfe3fa078a63616fb02cf889c31e"><div class="ttname"><a href="class_opt_parser.html#a72e2cfe3fa078a63616fb02cf889c31e">OptParser::pluginPlotRangeMin</a></div><div class="ttdeci">float pluginPlotRangeMin</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00121">OptParser.h:121</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a340bf1364f05efa46626fd54e568ed1c"><div class="ttname"><a href="class_method_abs_scan.html#a340bf1364f05efa46626fd54e568ed1c">MethodAbsScan::nPoints2dy</a></div><div class="ttdeci">int nPoints2dy</div><div class="ttdoc">number of scan points used by 2d scan, y axis </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00169">MethodAbsScan.h:169</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a2f29c1d8dbc0a7d62f172dcb714b6893"><div class="ttname"><a href="class_method_abs_scan.html#a2f29c1d8dbc0a7d62f172dcb714b6893">MethodAbsScan::pvalueCorrector</a></div><div class="ttdeci">PValueCorrection * pvalueCorrector</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00171">MethodAbsScan.h:171</a></div></div>
<div class="ttc" id="class_opt_parser_html_ad7f47fb98c4ffad002b4422c0c5666ce"><div class="ttname"><a href="class_opt_parser.html#ad7f47fb98c4ffad002b4422c0c5666ce">OptParser::plotid</a></div><div class="ttdeci">int plotid</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00096">OptParser.h:96</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a08c0a45f6fe34846871c0f0fb7e636ca"><div class="ttname"><a href="class_method_abs_scan.html#a08c0a45f6fe34846871c0f0fb7e636ca">MethodAbsScan::verbose</a></div><div class="ttdeci">bool verbose</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00202">MethodAbsScan.h:202</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_a00c5ad67ce4d5b1715b7d9805b1f8c2a"><div class="ttname"><a href="class_fit_result_cache.html#a00c5ad67ce4d5b1715b7d9805b1f8c2a">FitResultCache::initRoundRobinDB</a></div><div class="ttdeci">void initRoundRobinDB(const RooArgSet *set)</div><div class="ttdoc">Initialize all round robin slots to the parameters contained in set. </div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8cpp_source.html#l00077">FitResultCache.cpp:77</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a998d2723960844e61a8c2493a9237c0c"><div class="ttname"><a href="class_method_plugin_scan.html#a998d2723960844e61a8c2493a9237c0c">MethodPluginScan::profileLH</a></div><div class="ttdeci">MethodProbScan * profileLH</div><div class="ttdoc">external scanner holding the profile likelihood: DeltaChi2 of the scan PDF on data ...</div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8h_source.html#l00085">MethodPluginScan.h:85</a></div></div>
<div class="ttc" id="namespace_utils_html_ac3b068ca6b04243c7c48c38619c19ab4"><div class="ttname"><a href="namespace_utils.html#ac3b068ca6b04243c7c48c38619c19ab4">Utils::fitToMinForce</a></div><div class="ttdeci">RooFitResult * fitToMinForce(RooWorkspace *w, TString name, TString forceVariables=&quot;&quot;)</div><div class="ttdoc">Find the global minimum in a more thorough way. </div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00138">Utils.cpp:138</a></div></div>
<div class="ttc" id="class_toy_tree_html_a8fe124525918e9741a8a824d709be392"><div class="ttname"><a href="class_toy_tree.html#a8fe124525918e9741a8a824d709be392">ToyTree::scanbest</a></div><div class="ttdeci">float scanbest</div><div class="ttdoc">an alias to the free fit value of the scan variable </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00082">ToyTree.h:82</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_a9e6c2a0af38c5a719fbb9beb71b6ac63"><div class="ttname"><a href="class_fit_result_cache.html#a9e6c2a0af38c5a719fbb9beb71b6ac63">FitResultCache::getParsAtFunctionCall</a></div><div class="ttdeci">const RooArgSet * getParsAtFunctionCall()</div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8h_source.html#l00039">FitResultCache.h:39</a></div></div>
<div class="ttc" id="class_opt_parser_html_a67c391e9fd0b3f25222acb5501c8ddb6"><div class="ttname"><a href="class_opt_parser.html#a67c391e9fd0b3f25222acb5501c8ddb6">OptParser::toyFiles</a></div><div class="ttdeci">TString toyFiles</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00146">OptParser.h:146</a></div></div>
<div class="ttc" id="class_control_plots_html_a3b6ccecf4a199d12ed018182297c4176"><div class="ttname"><a href="class_control_plots.html#a3b6ccecf4a199d12ed018182297c4176">ControlPlots::ctrlPlotChi2Parabola</a></div><div class="ttdeci">void ctrlPlotChi2Parabola()</div><div class="ttdoc">Plot deltaChi2 of the toys versus the scan variable. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00431">ControlPlots.cpp:431</a></div></div>
<div class="ttc" id="class_control_plots_html_a98658a5b67fa01e38aec5dab43678ece"><div class="ttname"><a href="class_control_plots.html#a98658a5b67fa01e38aec5dab43678ece">ControlPlots::saveCtrlPlots</a></div><div class="ttdeci">void saveCtrlPlots()</div><div class="ttdoc">Save all control plots that were created so far. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00601">ControlPlots.cpp:601</a></div></div>
<div class="ttc" id="class_combiner_html"><div class="ttname"><a href="class_combiner.html">Combiner</a></div><div class="ttdef"><b>Definition:</b> <a href="_combiner_8h_source.html#l00018">Combiner.h:18</a></div></div>
<div class="ttc" id="namespace_utils_html_af7d597fb82d367478fac78b31a353c69"><div class="ttname"><a href="namespace_utils.html#af7d597fb82d367478fac78b31a353c69">Utils::setParameters</a></div><div class="ttdeci">void setParameters(const RooAbsCollection *setMe, const RooAbsCollection *values)</div><div class="ttdoc">Set each parameter in setMe to the value found in values. </div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00504">Utils.cpp:504</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_a89812bf2593bc75819f9660781ad8017"><div class="ttname"><a href="class_fit_result_cache.html#a89812bf2593bc75819f9660781ad8017">FitResultCache::getRoundRobinNminus</a></div><div class="ttdeci">const RooArgSet * getRoundRobinNminus(int n)</div><div class="ttdoc">Get an entry from the round robin database. </div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8cpp_source.html#l00090">FitResultCache.cpp:90</a></div></div>
<div class="ttc" id="class_fitter_html_a1da57f3b99a3303850ed4b0d8b222fdd"><div class="ttname"><a href="class_fitter.html#a1da57f3b99a3303850ed4b0d8b222fdd">Fitter::getStatus</a></div><div class="ttdeci">int getStatus()</div><div class="ttdoc">Check the fit result. </div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8cpp_source.html#l00100">Fitter.cpp:100</a></div></div>
<div class="ttc" id="class_control_plots_html_aea3d6bd801478b994631a386a3cba883"><div class="ttname"><a href="class_control_plots.html#aea3d6bd801478b994631a386a3cba883">ControlPlots::ctrlPlotObservables</a></div><div class="ttdeci">void ctrlPlotObservables()</div><div class="ttdoc">Plot all observables against the scan variable. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00346">ControlPlots.cpp:346</a></div></div>
<div class="ttc" id="class_opt_parser_html_a31acdc8dd4e3af6ae7717c533afb7075"><div class="ttname"><a href="class_opt_parser.html#a31acdc8dd4e3af6ae7717c533afb7075">OptParser::controlplot</a></div><div class="ttdeci">bool controlplot</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00048">OptParser.h:48</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a4b338fb0309f7930ccd773db414354e2"><div class="ttname"><a href="class_method_abs_scan.html#a4b338fb0309f7930ccd773db414354e2">MethodAbsScan::methodName</a></div><div class="ttdeci">TString methodName</div><div class="ttdoc">Prob, ... </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00159">MethodAbsScan.h:159</a></div></div>
<div class="ttc" id="class_toy_tree_html_a73eed094d360d546b1472e87fbb0e76f"><div class="ttname"><a href="class_toy_tree.html#a73eed094d360d546b1472e87fbb0e76f">ToyTree::storeParsScan</a></div><div class="ttdeci">void storeParsScan()</div><div class="ttdoc">Store the current workspace fit parameters as the scan fit result. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00350">ToyTree.cpp:350</a></div></div>
<div class="ttc" id="class_toy_tree_html_a13ac90d8ad13f98aeff5efc589f41b71"><div class="ttname"><a href="class_toy_tree.html#a13ac90d8ad13f98aeff5efc589f41b71">ToyTree::scanpointy</a></div><div class="ttdeci">float scanpointy</div><div class="ttdoc">the y scanpoint for 2D scans </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00074">ToyTree.h:74</a></div></div>
<div class="ttc" id="class_toy_tree_html_a531e6bb795c996b1ee25fd273b0e5fc7"><div class="ttname"><a href="class_toy_tree.html#a531e6bb795c996b1ee25fd273b0e5fc7">ToyTree::storeObservables</a></div><div class="ttdeci">void storeObservables()</div><div class="ttdoc">Store the current workspace observables. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00370">ToyTree.cpp:370</a></div></div>
<div class="ttc" id="class_fitter_html"><div class="ttname"><a href="class_fitter.html">Fitter</a></div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8h_source.html#l00018">Fitter.h:18</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a27f9304b33e6d1adba3d8895ed81d486"><div class="ttname"><a href="class_method_plugin_scan.html#a27f9304b33e6d1adba3d8895ed81d486">MethodPluginScan::getPvalue1d</a></div><div class="ttdeci">double getPvalue1d(RooSlimFitResult *plhScan, double chi2minGlobal, ToyTree *t=0, int id=0)</div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00404">MethodPluginScan.cpp:404</a></div></div>
<div class="ttc" id="class_roo_slim_fit_result_html_a6d2e6d8f177543db4555cbf2848b002b"><div class="ttname"><a href="class_roo_slim_fit_result.html#a6d2e6d8f177543db4555cbf2848b002b">RooSlimFitResult::getParVal</a></div><div class="ttdeci">float getParVal(TString name) const</div><div class="ttdoc">Return the value of a parameter contained in this fit result. </div><div class="ttdef"><b>Definition:</b> <a href="_roo_slim_fit_result_8cpp_source.html#l00127">RooSlimFitResult.cpp:127</a></div></div>
<div class="ttc" id="class_p_value_correction_html_a7c9b33683fc3b0e77c834b207c625486"><div class="ttname"><a href="class_p_value_correction.html#a7c9b33683fc3b0e77c834b207c625486">PValueCorrection::transform</a></div><div class="ttdeci">double transform(double x)</div><div class="ttdef"><b>Definition:</b> <a href="_p_value_correction_8cpp_source.html#l00088">PValueCorrection.cpp:88</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_ade703052dfaca9ce6d85e457fe4f2f3d"><div class="ttname"><a href="class_method_abs_scan.html#ade703052dfaca9ce6d85e457fe4f2f3d">MethodAbsScan::scanVar2</a></div><div class="ttdeci">TString scanVar2</div><div class="ttdoc">second scan parameter if we&amp;#39;re scanning 2d </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00166">MethodAbsScan.h:166</a></div></div>
<div class="ttc" id="class_p_d_f___datasets_html"><div class="ttname"><a href="class_p_d_f___datasets.html">PDF_Datasets</a></div><div class="ttdoc">Gamma Combination Author: Maximilian Schlupp, maxschlupp@gmail.com Author: Konstantin Schubert...</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f___datasets_8h_source.html#l00022">PDF_Datasets.h:22</a></div></div>
<div class="ttc" id="class_toy_tree_html_acf2f8e67eb573ad526f0e670bdb62c8b"><div class="ttname"><a href="class_toy_tree.html#acf2f8e67eb573ad526f0e670bdb62c8b">ToyTree::chi2min</a></div><div class="ttdeci">float chi2min</div><div class="ttdoc">the chi2 of the fit with var fixed to scan point </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00075">ToyTree.h:75</a></div></div>
<div class="ttc" id="class_combiner_html_a52da66fe433220563689cc9867b9ef22"><div class="ttname"><a href="class_combiner.html#a52da66fe433220563689cc9867b9ef22">Combiner::getWorkspace</a></div><div class="ttdeci">RooWorkspace * getWorkspace()</div><div class="ttdef"><b>Definition:</b> <a href="_combiner_8h_source.html#l00055">Combiner.h:55</a></div></div>
<div class="ttc" id="class_opt_parser_html_aec04c22f446fc1f80de739e68d95e642"><div class="ttname"><a href="class_opt_parser.html#aec04c22f446fc1f80de739e68d95e642">OptParser::isAction</a></div><div class="ttdeci">bool isAction(TString s)</div><div class="ttdoc">Check the –action argument. </div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8cpp_source.html#l00327">OptParser.cpp:327</a></div></div>
<div class="ttc" id="class_method_prob_scan_html"><div class="ttname"><a href="class_method_prob_scan.html">MethodProbScan</a></div><div class="ttdef"><b>Definition:</b> <a href="_method_prob_scan_8h_source.html#l00049">MethodProbScan.h:49</a></div></div>
<div class="ttc" id="class_combiner_html_a042e5238c3a27c9c404e2ce57fd38f5b"><div class="ttname"><a href="class_combiner.html#a042e5238c3a27c9c404e2ce57fd38f5b">Combiner::getTitle</a></div><div class="ttdeci">TString getTitle() const</div><div class="ttdef"><b>Definition:</b> <a href="_combiner_8h_source.html#l00048">Combiner.h:48</a></div></div>
<div class="ttc" id="class_toy_tree_html_a037a5472be834d5eaad3c7dba7e375b8"><div class="ttname"><a href="class_toy_tree.html#a037a5472be834d5eaad3c7dba7e375b8">ToyTree::getScanpointyMin</a></div><div class="ttdeci">float getScanpointyMin()</div><div class="ttdoc">Get minimum of scanpointy variable found in the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00495">ToyTree.cpp:495</a></div></div>
<div class="ttc" id="class_toy_tree_html_adcc4f5eead3005c6b5741d99112cff9c"><div class="ttname"><a href="class_toy_tree.html#adcc4f5eead3005c6b5741d99112cff9c">ToyTree::id</a></div><div class="ttdeci">float id</div><div class="ttdoc">an ID to distinguish different conditions, e.g. different toys in a coverage test ...</div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00088">ToyTree.h:88</a></div></div>
<div class="ttc" id="class_roo_slim_fit_result_html"><div class="ttname"><a href="class_roo_slim_fit_result.html">RooSlimFitResult</a></div><div class="ttdoc">Class that essentially mimics the functionality of a RooFitResult, but uses less internal memory by n...</div><div class="ttdef"><b>Definition:</b> <a href="_roo_slim_fit_result_8h_source.html#l00031">RooSlimFitResult.h:31</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_ad2bc4c400c285a848e85c56d7c6842c4"><div class="ttname"><a href="class_fit_result_cache.html#ad2bc4c400c285a848e85c56d7c6842c4">FitResultCache::storeParsAtFunctionCall</a></div><div class="ttdeci">void storeParsAtFunctionCall(const RooArgSet *set)</div><div class="ttdoc">Store the parameters held by set. </div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8cpp_source.html#l00030">FitResultCache.cpp:30</a></div></div>
<div class="ttc" id="class_toy_tree_html_aa8fab63fb870977bcdd4ca07dd0428bd"><div class="ttname"><a href="class_toy_tree.html#aa8fab63fb870977bcdd4ca07dd0428bd">ToyTree::fill</a></div><div class="ttdeci">void fill()</div><div class="ttdoc">Save current values of the proxy variables as an event into the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00103">ToyTree.cpp:103</a></div></div>
<div class="ttc" id="class_control_plots_html_ae7f0ede8f8139ff6546425e6104e4cc5"><div class="ttname"><a href="class_control_plots.html#ae7f0ede8f8139ff6546425e6104e4cc5">ControlPlots::ctrlPlotPvalue</a></div><div class="ttdeci">void ctrlPlotPvalue()</div><div class="ttdoc">Make p-value control plots. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00023">ControlPlots.cpp:23</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a103c6146df541ace37fc0abcbbcc4862"><div class="ttname"><a href="class_method_plugin_scan.html#a103c6146df541ace37fc0abcbbcc4862">MethodPluginScan::nToys</a></div><div class="ttdeci">int nToys</div><div class="ttdoc">number of toys to be generated at each scan point </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8h_source.html#l00084">MethodPluginScan.h:84</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_acd6f67847244f0e510f940b2af061caa"><div class="ttname"><a href="class_method_abs_scan.html#acd6f67847244f0e510f940b2af061caa">MethodAbsScan::nPoints2dx</a></div><div class="ttdeci">int nPoints2dx</div><div class="ttdoc">number of scan points used by 2d scan, x axis </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00168">MethodAbsScan.h:168</a></div></div>
<div class="ttc" id="class_toy_tree_html_a0d1e48ee179a4802bc46b3802b8c8a08"><div class="ttname"><a href="class_toy_tree.html#a0d1e48ee179a4802bc46b3802b8c8a08">ToyTree::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">Initialize a new TTree, set up all its leaves, connect them to the proxy variables. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00136">ToyTree.cpp:136</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_af8afa73f3e6053ee0fc4299688780d8c"><div class="ttname"><a href="class_method_abs_scan.html#af8afa73f3e6053ee0fc4299688780d8c">MethodAbsScan::hCL2d</a></div><div class="ttdeci">TH2F * hCL2d</div><div class="ttdoc">1-CL curve </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00187">MethodAbsScan.h:187</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a67571118ba5fe0a03e1a7ff39c9922e7"><div class="ttname"><a href="class_method_plugin_scan.html#a67571118ba5fe0a03e1a7ff39c9922e7">MethodPluginScan::setParevolPLH</a></div><div class="ttdeci">void setParevolPLH(MethodProbScan *s)</div><div class="ttdoc">Set the parameter evolution over the profile likelihood that was previously computed by a MethodProbS...</div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00084">MethodPluginScan.cpp:84</a></div></div>
<div class="ttc" id="class_toy_tree_html_a24bb7bd147f4f8a74bf62852949cac4f"><div class="ttname"><a href="class_toy_tree.html#a24bb7bd147f4f8a74bf62852949cac4f">ToyTree::chi2minGlobalToy</a></div><div class="ttdeci">float chi2minGlobalToy</div><div class="ttdoc">the chi2 of the free fit to the toy </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00079">ToyTree.h:79</a></div></div>
<div class="ttc" id="class_toy_tree_html_a29e9168e785045d9cf285534f0c4c444"><div class="ttname"><a href="class_toy_tree.html#a29e9168e785045d9cf285534f0c4c444">ToyTree::storeParsFree</a></div><div class="ttdeci">void storeParsFree()</div><div class="ttdoc">Store the current workspace fit parameters as the free fit result. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00324">ToyTree.cpp:324</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a07b9165df769293df568086b57bad4ab"><div class="ttname"><a href="class_method_abs_scan.html#a07b9165df769293df568086b57bad4ab">MethodAbsScan::pdfName</a></div><div class="ttdeci">TString pdfName</div><div class="ttdoc">PDF name in workspace, derived from name. </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00160">MethodAbsScan.h:160</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_afb3e22e6adf5b766f96e757a9b0153a2"><div class="ttname"><a href="class_fit_result_cache.html#afb3e22e6adf5b766f96e757a9b0153a2">FitResultCache::storeParsRoundRobin</a></div><div class="ttdeci">void storeParsRoundRobin(const RooArgSet *set)</div><div class="ttdoc">Store the parameters held by set into the round robin database. </div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8cpp_source.html#l00061">FitResultCache.cpp:61</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_afdf82f7698b32de779af40925e4a008f"><div class="ttname"><a href="class_method_abs_scan.html#afdf82f7698b32de779af40925e4a008f">MethodAbsScan::curveResults2d</a></div><div class="ttdeci">vector&lt; vector&lt; RooSlimFitResult * &gt; &gt; curveResults2d</div><div class="ttdoc">All fit results of the the points that make it into the 1-CL curve. </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00146">MethodAbsScan.h:146</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_ada4773784f6e1cf1f5d83163e25caaeb"><div class="ttname"><a href="class_fit_result_cache.html#ada4773784f6e1cf1f5d83163e25caaeb">FitResultCache::storeParsAtGlobalMin</a></div><div class="ttdeci">void storeParsAtGlobalMin(const RooArgSet *set)</div><div class="ttdoc">Store the parameters held by set. </div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8cpp_source.html#l00048">FitResultCache.cpp:48</a></div></div>
<div class="ttc" id="class_toy_tree_html_adf587e46375e1f7c6abb2e5bf94e8aec"><div class="ttname"><a href="class_toy_tree.html#adf587e46375e1f7c6abb2e5bf94e8aec">ToyTree::nrun</a></div><div class="ttdeci">float nrun</div><div class="ttdoc">an ID to distinguish different runs, i.e. batch jobs </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00085">ToyTree.h:85</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a1bcb591ad64da44a33ff86a166f41b76"><div class="ttname"><a href="class_method_abs_scan.html#a1bcb591ad64da44a33ff86a166f41b76">MethodAbsScan::combiner</a></div><div class="ttdeci">Combiner * combiner</div><div class="ttdoc">the combination </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00205">MethodAbsScan.h:205</a></div></div>
<div class="ttc" id="class_opt_parser_html_ae9380482af3f93c022ac948a8ef2c276"><div class="ttname"><a href="class_opt_parser.html#ae9380482af3f93c022ac948a8ef2c276">OptParser::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00065">OptParser.h:65</a></div></div>
<div class="ttc" id="class_control_plots_html_a10e04d68921beb2316c1d10ce3e0b82b"><div class="ttname"><a href="class_control_plots.html#a10e04d68921beb2316c1d10ce3e0b82b">ControlPlots::ctrlPlotChi2Distribution</a></div><div class="ttdeci">void ctrlPlotChi2Distribution()</div><div class="ttdoc">Plot the deltaChi2 distribution of the toys in bins of the scan point, compare to the Gaussian assump...</div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00392">ControlPlots.cpp:392</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a043ca474d289dc12be72e6a3a63432cf"><div class="ttname"><a href="class_method_abs_scan.html#a043ca474d289dc12be72e6a3a63432cf">MethodAbsScan::getScanVar1Name</a></div><div class="ttdeci">TString getScanVar1Name()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8cpp_source.html#l00939">MethodAbsScan.cpp:939</a></div></div>
<div class="ttc" id="class_toy_tree_html_aff8496d8eb1780bdd14fbd274a207b40"><div class="ttname"><a href="class_toy_tree.html#aff8496d8eb1780bdd14fbd274a207b40">ToyTree::getScanpointMax</a></div><div class="ttdeci">float getScanpointMax()</div><div class="ttdoc">Get maximum of scanpoint variable found in the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00477">ToyTree.cpp:477</a></div></div>
<div class="ttc" id="namespace_utils_html_aa2fb91bef0f6564917776743ec747153"><div class="ttname"><a href="namespace_utils.html#aa2fb91bef0f6564917776743ec747153">Utils::randomizeParameters</a></div><div class="ttdeci">void randomizeParameters(RooWorkspace *w, TString setname)</div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00418">Utils.cpp:418</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a2aef1d50aee5be2551ea3bf91d420ad3"><div class="ttname"><a href="class_method_abs_scan.html#a2aef1d50aee5be2551ea3bf91d420ad3">MethodAbsScan::parsName</a></div><div class="ttdeci">TString parsName</div><div class="ttdoc">set name of physics parameters, derived from name </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00162">MethodAbsScan.h:162</a></div></div>
<div class="ttc" id="class_toy_tree_html_a486c0fe0599cae1c1162f923aef9cac2"><div class="ttname"><a href="class_toy_tree.html#a486c0fe0599cae1c1162f923aef9cac2">ToyTree::chi2minToy</a></div><div class="ttdeci">float chi2minToy</div><div class="ttdoc">the chi2 of the fit to the toy with var fixed to scan point </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00078">ToyTree.h:78</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_af8c156e63f62d47cfe2a566b91813ab8"><div class="ttname"><a href="class_method_plugin_scan.html#af8c156e63f62d47cfe2a566b91813ab8">MethodPluginScan::parevolPLH</a></div><div class="ttdeci">MethodProbScan * parevolPLH</div><div class="ttdoc">external scanner defining the parameter evolution: set to profileLH unless for the Hybrid Plugin ...</div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8h_source.html#l00086">MethodPluginScan.h:86</a></div></div>
<div class="ttc" id="class_combiner_html_a274f4ba80749257995701d07d1fc0458"><div class="ttname"><a href="class_combiner.html#a274f4ba80749257995701d07d1fc0458">Combiner::loadParameterLimits</a></div><div class="ttdeci">void loadParameterLimits()</div><div class="ttdoc">Activate limits for all parameters. </div><div class="ttdef"><b>Definition:</b> <a href="_combiner_8cpp_source.html#l00518">Combiner.cpp:518</a></div></div>
<div class="ttc" id="class_opt_parser_html_aab591067f8ec321c0e4eb80e98342192"><div class="ttname"><a href="class_opt_parser.html#aab591067f8ec321c0e4eb80e98342192">OptParser::scanforce</a></div><div class="ttdeci">bool scanforce</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00139">OptParser.h:139</a></div></div>
<div class="ttc" id="namespace_utils_html_ae3f723d44400db8a1e99985411f581fa"><div class="ttname"><a href="namespace_utils.html#ae3f723d44400db8a1e99985411f581fa">Utils::FileExists</a></div><div class="ttdeci">bool FileExists(TString strFilename)</div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00793">Utils.cpp:793</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_aad49715e0d75d39f40fc1c652bc43187"><div class="ttname"><a href="class_method_abs_scan.html#aad49715e0d75d39f40fc1c652bc43187">MethodAbsScan::name</a></div><div class="ttdeci">TString name</div><div class="ttdoc">basename, e.g. ggsz </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00157">MethodAbsScan.h:157</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a9c41ad75a73c87263ac2af17db775b01"><div class="ttname"><a href="class_method_abs_scan.html#a9c41ad75a73c87263ac2af17db775b01">MethodAbsScan::scan1d</a></div><div class="ttdeci">virtual int scan1d()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8cpp_source.html#l00458">MethodAbsScan.cpp:458</a></div></div>
<div class="ttc" id="class_fit_result_cache_html"><div class="ttname"><a href="class_fit_result_cache.html">FitResultCache</a></div><div class="ttdoc">Helper class for the scan methods. </div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8h_source.html#l00027">FitResultCache.h:27</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_ade0b5756f286cbbb08395a9baa080fff"><div class="ttname"><a href="class_method_abs_scan.html#ade0b5756f286cbbb08395a9baa080fff">MethodAbsScan::setSolutions</a></div><div class="ttdeci">void setSolutions(vector&lt; RooSlimFitResult *&gt; s)</div><div class="ttdoc">Helper function to copy over solutions from another scanner. </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8cpp_source.html#l01398">MethodAbsScan.cpp:1398</a></div></div>
<div class="ttc" id="class_opt_parser_html_a5f29c52609a9a1259aab224f4070d015"><div class="ttname"><a href="class_opt_parser.html#a5f29c52609a9a1259aab224f4070d015">OptParser::intprob</a></div><div class="ttdeci">bool intprob</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00120">OptParser.h:120</a></div></div>
<div class="ttc" id="namespace_utils_html_aa2eaac5d4890c406314cb0013d2f5cfd"><div class="ttname"><a href="namespace_utils.html#aa2eaac5d4890c406314cb0013d2f5cfd">Utils::getUniqueRootName</a></div><div class="ttdeci">TString getUniqueRootName()</div><div class="ttdef"><b>Definition:</b> <a href="_utils_8h_source.html#l00122">Utils.h:122</a></div></div>
<div class="ttc" id="class_roo_slim_fit_result_html_a1940d2c56c8097295272323e740035db"><div class="ttname"><a href="class_roo_slim_fit_result.html#a1940d2c56c8097295272323e740035db">RooSlimFitResult::hasParameter</a></div><div class="ttdeci">bool hasParameter(TString name) const</div><div class="ttdoc">Check if a parameter is contained in this fit result. </div><div class="ttdef"><b>Definition:</b> <a href="_roo_slim_fit_result_8cpp_source.html#l00155">RooSlimFitResult.cpp:155</a></div></div>
<div class="ttc" id="namespace_utils_html_a240dfac0ed26bffcd7c9403c546aa27a"><div class="ttname"><a href="namespace_utils.html#a240dfac0ed26bffcd7c9403c546aa27a">Utils::setLimit</a></div><div class="ttdeci">void setLimit(RooRealVar *v, TString limitname)</div><div class="ttdoc">Load a named parameter range for a certain parameter. </div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00663">Utils.cpp:663</a></div></div>
<div class="ttc" id="class_opt_parser_html_a5c3823719fdcd44aa8c48f828f7f5847"><div class="ttname"><a href="class_opt_parser.html#a5c3823719fdcd44aa8c48f828f7f5847">OptParser::importance</a></div><div class="ttdeci">bool importance</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00066">OptParser.h:66</a></div></div>
<div class="ttc" id="class_opt_parser_html_a03d7379f8eec577975369efd8016ce98"><div class="ttname"><a href="class_opt_parser.html#a03d7379f8eec577975369efd8016ce98">OptParser::npointstoy</a></div><div class="ttdeci">int npointstoy</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00086">OptParser.h:86</a></div></div>
<div class="ttc" id="class_method_abs_scan_html"><div class="ttname"><a href="class_method_abs_scan.html">MethodAbsScan</a></div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00044">MethodAbsScan.h:44</a></div></div>
<div class="ttc" id="class_progress_bar_html_a38e85c69766cc125d04106fdd9afc555"><div class="ttname"><a href="class_progress_bar.html#a38e85c69766cc125d04106fdd9afc555">ProgressBar::skipSteps</a></div><div class="ttdeci">void skipSteps(unsigned int n)</div><div class="ttdoc">Increase the internal count by n steps. </div><div class="ttdef"><b>Definition:</b> <a href="_progress_bar_8cpp_source.html#l00067">ProgressBar.cpp:67</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a09fd634c9fad18c466f8b3ee2ad63b1c"><div class="ttname"><a href="class_method_abs_scan.html#a09fd634c9fad18c466f8b3ee2ad63b1c">MethodAbsScan::w</a></div><div class="ttdeci">RooWorkspace * w</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00175">MethodAbsScan.h:175</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a5073ddd058b98a555e12b11caac5f204"><div class="ttname"><a href="class_method_abs_scan.html#a5073ddd058b98a555e12b11caac5f204">MethodAbsScan::getChi2minGlobal</a></div><div class="ttdeci">float getChi2minGlobal()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00058">MethodAbsScan.h:58</a></div></div>
<div class="ttc" id="class_roo_slim_fit_result_html_a76e7f4a2df321d22a919bed6c05db763"><div class="ttname"><a href="class_roo_slim_fit_result.html#a76e7f4a2df321d22a919bed6c05db763">RooSlimFitResult::floatParsFinal</a></div><div class="ttdeci">RooArgList &amp; floatParsFinal() const</div><div class="ttdoc">Return a RooArgList of RooRealVars that constitute the floating fit parameters. </div><div class="ttdef"><b>Definition:</b> <a href="_roo_slim_fit_result_8cpp_source.html#l00071">RooSlimFitResult.cpp:71</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a3991352427c7713b6167fa9c1dc926e7"><div class="ttname"><a href="class_method_abs_scan.html#a3991352427c7713b6167fa9c1dc926e7">MethodAbsScan::title</a></div><div class="ttdeci">TString title</div><div class="ttdoc">nice string for the legends </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00158">MethodAbsScan.h:158</a></div></div>
<div class="ttc" id="class_control_plots_html_a2197c4624ae049abce94fdd9bfbddcf8"><div class="ttname"><a href="class_control_plots.html#a2197c4624ae049abce94fdd9bfbddcf8">ControlPlots::ctrlPlotMore</a></div><div class="ttdeci">void ctrlPlotMore(MethodProbScan *profileLH)</div><div class="ttdoc">Some more control plots. </div><div class="ttdef"><b>Definition:</b> <a href="_control_plots_8cpp_source.html#l00474">ControlPlots.cpp:474</a></div></div>
<div class="ttc" id="class_roo_slim_fit_result_html_a08d6e4887513492d5501a65950ba029c"><div class="ttname"><a href="class_roo_slim_fit_result.html#a08d6e4887513492d5501a65950ba029c">RooSlimFitResult::minNll</a></div><div class="ttdeci">Double_t minNll() const</div><div class="ttdef"><b>Definition:</b> <a href="_roo_slim_fit_result_8h_source.html#l00052">RooSlimFitResult.h:52</a></div></div>
<div class="ttc" id="class_fitter_html_a52b73cd92e9fd87e6c0ab853faea1cf0"><div class="ttname"><a href="class_fitter.html#a52b73cd92e9fd87e6c0ab853faea1cf0">Fitter::getChi2</a></div><div class="ttdeci">float getChi2()</div><div class="ttdoc">Returns minimum chi2 value obtained by fit(). </div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8cpp_source.html#l00088">Fitter.cpp:88</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_aa4d2d0b64a5886c2f8e5e61dcb0c55b9"><div class="ttname"><a href="class_method_plugin_scan.html#aa4d2d0b64a5886c2f8e5e61dcb0c55b9">MethodPluginScan::MethodPluginScan</a></div><div class="ttdeci">MethodPluginScan(MethodProbScan *s)</div><div class="ttdoc">Initialize from a previous Prob scan, setting the profile likelihood. </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00014">MethodPluginScan.cpp:14</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a1df0e00f7c416e2405fffe3be8153d7d"><div class="ttname"><a href="class_method_abs_scan.html#a1df0e00f7c416e2405fffe3be8153d7d">MethodAbsScan::getTitle</a></div><div class="ttdeci">TString getTitle()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00101">MethodAbsScan.h:101</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a8106f9ab1c1df885657a9c359a635d52"><div class="ttname"><a href="class_method_plugin_scan.html#a8106f9ab1c1df885657a9c359a635d52">MethodPluginScan::readScan2dTrees</a></div><div class="ttdeci">void readScan2dTrees(int runMin=1, int runMax=1)</div><div class="ttdoc">Read in the TTrees that were produced by scan2d(). </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l01024">MethodPluginScan.cpp:1024</a></div></div>
<div class="ttc" id="class_fitter_html_a5d02c5744f8fc0f1116a986dbe605e41"><div class="ttname"><a href="class_fitter.html#a5d02c5744f8fc0f1116a986dbe605e41">Fitter::print</a></div><div class="ttdeci">void print()</div><div class="ttdef"><b>Definition:</b> <a href="_fitter_8cpp_source.html#l00119">Fitter.cpp:119</a></div></div>
<div class="ttc" id="class_toy_tree_html_a1629ef86af376c87594eb0e9ce5d4e77"><div class="ttname"><a href="class_toy_tree.html#a1629ef86af376c87594eb0e9ce5d4e77">ToyTree::getScanpointN</a></div><div class="ttdeci">int getScanpointN()</div><div class="ttdoc">Get number of different values of the scanpoint variable found in the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00486">ToyTree.cpp:486</a></div></div>
<div class="ttc" id="class_toy_tree_html_a9a56ce4c6bf403eca49dcfdde2748acf"><div class="ttname"><a href="class_toy_tree.html#a9a56ce4c6bf403eca49dcfdde2748acf">ToyTree::GetEntries</a></div><div class="ttdeci">Long64_t GetEntries()</div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00377">ToyTree.cpp:377</a></div></div>
<div class="ttc" id="class_toy_tree_html"><div class="ttname"><a href="class_toy_tree.html">ToyTree</a></div><div class="ttdoc">Interface class for the root trees that are written by the Plugin method and related functions...</div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00033">ToyTree.h:33</a></div></div>
<div class="ttc" id="_method_plugin_scan_8h_html"><div class="ttname"><a href="_method_plugin_scan_8h.html">MethodPluginScan.h</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a6f1c2337a325157aca1127608afc3d07"><div class="ttname"><a href="class_method_abs_scan.html#a6f1c2337a325157aca1127608afc3d07">MethodAbsScan::obsDataset</a></div><div class="ttdeci">RooDataSet * obsDataset</div><div class="ttdoc">save the nominal observables so we can restore them after we have fitted toys </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00176">MethodAbsScan.h:176</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_aae72ccd1a439d3cebdddeb1ac81ffe6e"><div class="ttname"><a href="class_method_abs_scan.html#aae72ccd1a439d3cebdddeb1ac81ffe6e">MethodAbsScan::setChi2minGlobal</a></div><div class="ttdeci">void setChi2minGlobal(double x)</div><div class="ttdoc">Set the global minimum manually. </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8cpp_source.html#l00194">MethodAbsScan.cpp:194</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a12aeeda5449d392156317c7787a0b332"><div class="ttname"><a href="class_method_abs_scan.html#a12aeeda5449d392156317c7787a0b332">MethodAbsScan::getHCL2d</a></div><div class="ttdeci">TH2F * getHCL2d()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00074">MethodAbsScan.h:74</a></div></div>
<div class="ttc" id="class_method_prob_scan_html_a9d7e70f45ab16ca37782a0a5ae3fe905"><div class="ttname"><a href="class_method_prob_scan.html#a9d7e70f45ab16ca37782a0a5ae3fe905">MethodProbScan::getChi2min</a></div><div class="ttdeci">float getChi2min(float scanpoint)</div><div class="ttdoc">Get the chi2 value of the profile likelihood at a given scan point. </div><div class="ttdef"><b>Definition:</b> <a href="_method_prob_scan_8cpp_source.html#l00705">MethodProbScan.cpp:705</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_ad6186a5870df0ddacc0983d84439b125"><div class="ttname"><a href="class_method_plugin_scan.html#ad6186a5870df0ddacc0983d84439b125">MethodPluginScan::getParevolPoint</a></div><div class="ttdeci">RooSlimFitResult * getParevolPoint(float scanpoint)</div><div class="ttdoc">Helper function for scan1d(). </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00101">MethodPluginScan.cpp:101</a></div></div>
<div class="ttc" id="class_opt_parser_html_a0f75e7d5a24ab582b8966dd7126c3995"><div class="ttname"><a href="class_opt_parser.html#a0f75e7d5a24ab582b8966dd7126c3995">OptParser::isQuickhack</a></div><div class="ttdeci">bool isQuickhack(int id)</div><div class="ttdoc">Check the –quickhack argument. </div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8cpp_source.html#l00335">OptParser.cpp:335</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a66da3e4d4a59e980b59a2404fcbf990d"><div class="ttname"><a href="class_method_abs_scan.html#a66da3e4d4a59e980b59a2404fcbf990d">MethodAbsScan::hCL</a></div><div class="ttdeci">TH1F * hCL</div><div class="ttdoc">1-CL curve </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00179">MethodAbsScan.h:179</a></div></div>
<div class="ttc" id="class_toy_tree_html_add900d64485baf7f0bf3881a2f3002c5"><div class="ttname"><a href="class_toy_tree.html#add900d64485baf7f0bf3881a2f3002c5">ToyTree::getScanpointyN</a></div><div class="ttdeci">int getScanpointyN()</div><div class="ttdoc">Get number of different values of the scanpointy variable found in the TTree. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00513">ToyTree.cpp:513</a></div></div>
<div class="ttc" id="class_toy_tree_html_a30c545bc09f33b1f6c8ce4968e965803"><div class="ttname"><a href="class_toy_tree.html#a30c545bc09f33b1f6c8ce4968e965803">ToyTree::scanpoint</a></div><div class="ttdeci">float scanpoint</div><div class="ttdoc">the scanpoint for 1D scans, or the x scanpoint for 2D scans </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00073">ToyTree.h:73</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_a65c328571a2d1b1843d8947436ca47d5"><div class="ttname"><a href="class_method_abs_scan.html#a65c328571a2d1b1843d8947436ca47d5">MethodAbsScan::scanVar1</a></div><div class="ttdeci">TString scanVar1</div><div class="ttdoc">scan parameter </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00165">MethodAbsScan.h:165</a></div></div>
<div class="ttc" id="class_toy_tree_html_ab288fe3b61a6b6990661798bad2b71b2"><div class="ttname"><a href="class_toy_tree.html#ab288fe3b61a6b6990661798bad2b71b2">ToyTree::writeToFile</a></div><div class="ttdeci">void writeToFile(TString fName)</div><div class="ttdoc">Save the TTree into a root file. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00111">ToyTree.cpp:111</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_aaa5a2e2456960a13996b4bc3a8a9e79f"><div class="ttname"><a href="class_method_abs_scan.html#aaa5a2e2456960a13996b4bc3a8a9e79f">MethodAbsScan::obsName</a></div><div class="ttdeci">TString obsName</div><div class="ttdoc">dataset name of observables, derived from name </div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00161">MethodAbsScan.h:161</a></div></div>
<div class="ttc" id="class_p_d_f___datasets_html_ad444f8aece4cda843161c84663ecf995"><div class="ttname"><a href="class_p_d_f___datasets.html#ad444f8aece4cda843161c84663ecf995">PDF_Datasets::getWorkspace</a></div><div class="ttdeci">RooWorkspace * getWorkspace()</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f___datasets_8h_source.html#l00068">PDF_Datasets.h:68</a></div></div>
<div class="ttc" id="class_toy_tree_html_ac8d95f690655517a61b1829ce01d7a0e"><div class="ttname"><a href="class_toy_tree.html#ac8d95f690655517a61b1829ce01d7a0e">ToyTree::scanbesty</a></div><div class="ttdeci">float scanbesty</div><div class="ttdoc">an alias to the free fit value of the scan y variable in 2D scans </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00083">ToyTree.h:83</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a6f24739fc1c65a9ef1109684bb547850"><div class="ttname"><a href="class_method_plugin_scan.html#a6f24739fc1c65a9ef1109684bb547850">MethodPluginScan::importance</a></div><div class="ttdeci">double importance(double pvalue)</div><div class="ttdoc">Importance sampling for low p-values: Returns a value between 0.05 and 1 which can be used to scale d...</div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l01181">MethodPluginScan.cpp:1181</a></div></div>
<div class="ttc" id="class_toy_tree_html_a3907a027f285e2cd132cfbce0e343128"><div class="ttname"><a href="class_toy_tree.html#a3907a027f285e2cd132cfbce0e343128">ToyTree::storeTheory</a></div><div class="ttdeci">void storeTheory()</div><div class="ttdoc">Store the current workspace theory parameters. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00360">ToyTree.cpp:360</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_ae555381f1c26bc057f371edf2f62239d"><div class="ttname"><a href="class_method_abs_scan.html#ae555381f1c26bc057f371edf2f62239d">MethodAbsScan::scan2d</a></div><div class="ttdeci">virtual int scan2d()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8cpp_source.html#l00465">MethodAbsScan.cpp:465</a></div></div>
<div class="ttc" id="class_fit_result_cache_html_a6ce68f04512df9b0521bcdd23a984d75"><div class="ttname"><a href="class_fit_result_cache.html#a6ce68f04512df9b0521bcdd23a984d75">FitResultCache::getParsAtGlobalMin</a></div><div class="ttdeci">const RooArgSet * getParsAtGlobalMin()</div><div class="ttdef"><b>Definition:</b> <a href="_fit_result_cache_8h_source.html#l00040">FitResultCache.h:40</a></div></div>
<div class="ttc" id="class_method_abs_scan_html_afb7d91a984b4cb12c1bdde8682ef996a"><div class="ttname"><a href="class_method_abs_scan.html#afb7d91a984b4cb12c1bdde8682ef996a">MethodAbsScan::getHCL</a></div><div class="ttdeci">TH1F * getHCL()</div><div class="ttdef"><b>Definition:</b> <a href="_method_abs_scan_8h_source.html#l00066">MethodAbsScan.h:66</a></div></div>
<div class="ttc" id="class_method_plugin_scan_html_a941fb4f3aa086bb212c207df354494b7"><div class="ttname"><a href="class_method_plugin_scan.html#a941fb4f3aa086bb212c207df354494b7">MethodPluginScan::generateToys</a></div><div class="ttdeci">RooDataSet * generateToys(int nToys)</div><div class="ttdoc">Generate toys. </div><div class="ttdef"><b>Definition:</b> <a href="_method_plugin_scan_8cpp_source.html#l00139">MethodPluginScan.cpp:139</a></div></div>
<div class="ttc" id="class_toy_tree_html_ae693f0391e064867cb20f0ea12709925"><div class="ttname"><a href="class_toy_tree.html#ae693f0391e064867cb20f0ea12709925">ToyTree::activateAllBranches</a></div><div class="ttdeci">void activateAllBranches()</div><div class="ttdoc">Activate all branches. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00297">ToyTree.cpp:297</a></div></div>
<div class="ttc" id="class_opt_parser_html_abb2aa96bb0b16b3dd406662758c8e585"><div class="ttname"><a href="class_opt_parser.html#abb2aa96bb0b16b3dd406662758c8e585">OptParser::pluginPlotRangeMax</a></div><div class="ttdeci">float pluginPlotRangeMax</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00122">OptParser.h:122</a></div></div>
<div class="ttc" id="class_opt_parser_html_a48af098abd03f950260b42c1c432a3c0"><div class="ttname"><a href="class_opt_parser.html#a48af098abd03f950260b42c1c432a3c0">OptParser::ntoys</a></div><div class="ttdeci">int ntoys</div><div class="ttdef"><b>Definition:</b> <a href="_opt_parser_8h_source.html#l00089">OptParser.h:89</a></div></div>
<div class="ttc" id="class_toy_tree_html_aa2f568a8bccb63ca73396080d63d6bb3"><div class="ttname"><a href="class_toy_tree.html#aa2f568a8bccb63ca73396080d63d6bb3">ToyTree::storeParsPll</a></div><div class="ttdeci">void storeParsPll()</div><div class="ttdoc">Store the current workspace fit parameters as the profile likelihood parameters. </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8cpp_source.html#l00306">ToyTree.cpp:306</a></div></div>
<div class="ttc" id="class_toy_tree_html_a5373be3cfbfbe7a4b823da05229cfec5"><div class="ttname"><a href="class_toy_tree.html#a5373be3cfbfbe7a4b823da05229cfec5">ToyTree::chi2minGlobal</a></div><div class="ttdeci">float chi2minGlobal</div><div class="ttdoc">the chi2 of the free fit </div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00076">ToyTree.h:76</a></div></div>
<div class="ttc" id="namespace_utils_html_a28c18df87e6229c5d5f593184957e957"><div class="ttname"><a href="namespace_utils.html#a28c18df87e6229c5d5f593184957e957">Utils::fitToMinBringBackAngles</a></div><div class="ttdeci">RooFitResult * fitToMinBringBackAngles(RooAbsPdf *pdf, bool thorough, int printLevel)</div><div class="ttdoc">Fit a pdf to the minimum, but keep angular parameters in a range of [0,2pi]. </div><div class="ttdef"><b>Definition:</b> <a href="_utils_8cpp_source.html#l00098">Utils.cpp:98</a></div></div>
<div class="ttc" id="class_p_d_f___datasets_html_a19a4cb988efbc07d1dbd9f6fede75de1"><div class="ttname"><a href="class_p_d_f___datasets.html#a19a4cb988efbc07d1dbd9f6fede75de1">PDF_Datasets::getObsName</a></div><div class="ttdeci">TString getObsName()</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_f___datasets_8h_source.html#l00062">PDF_Datasets.h:62</a></div></div>
<div class="ttc" id="class_toy_tree_html_a8972016fb1bcd71d91ec6f20cf253691"><div class="ttname"><a href="class_toy_tree.html#a8972016fb1bcd71d91ec6f20cf253691">ToyTree::statusScan</a></div><div class="ttdeci">float statusScan</div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00091">ToyTree.h:91</a></div></div>
<div class="ttc" id="class_toy_tree_html_ad28bff5a7627de45a87a6d67efc3c49f"><div class="ttname"><a href="class_toy_tree.html#ad28bff5a7627de45a87a6d67efc3c49f">ToyTree::statusFree</a></div><div class="ttdeci">float statusFree</div><div class="ttdef"><b>Definition:</b> <a href="_toy_tree_8h_source.html#l00089">ToyTree.h:89</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 28 2017 15:18:58 for GammaCombo by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
